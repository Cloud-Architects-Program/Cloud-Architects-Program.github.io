
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://cloud-architects-program.github.io/ycit019_Module_9_Kubernetes_Features/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>ycit019 Module 9 Kubernetes Features - Cloud Architecture</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#0-create-gke-cluster" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Cloud Architecture" class="md-header__button md-logo" aria-label="Cloud Architecture" data-md-component="logo">
      
  <img src="../images/k8s.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cloud Architecture
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ycit019 Module 9 Kubernetes Features
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Cloud-Architects-Program/assignment" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Cloud Architecture" class="md-nav__button md-logo" aria-label="Cloud Architecture" data-md-component="logo">
      
  <img src="../images/k8s.svg" alt="logo">

    </a>
    Cloud Architecture
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Cloud-Architects-Program/assignment" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cloud Native Administrator
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Cloud Native Administrator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Module 5 - Docker Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Module 5 - Docker Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../presentation5.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Presentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readingmat_5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reading materials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Module_5_Lab_Docker_basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignment5_dockerbas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quiz_5_dockerbas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quizzes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../add_mat_5_docker_basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Additional Materials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary_5_docker_basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Module 6 - Advanced Docker
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Module 6 - Advanced Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readingmat_6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reading materials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Module_6_Lab_Advanced_Docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignment6_docker_adv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quiz_6_docker_adv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quizzes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../add_mat_6_docker_adv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Additional Materials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary_6_docker_adv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Module 7 - Introduction to Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Module 7 - Introduction to Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readingmat_7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reading materials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Module_7_Lab_Deploy_Kubernetes_kubeadm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quiz_7_introK8s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quizzes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../add_mat_7_introK8s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Additional Materials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary_7_introK8s/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Module 8 - Kuberenetes Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Module 8 - Kuberenetes Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readingmat_8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reading materials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Module_8_Lab_Kubernetes_Concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assignment8_k8s_concept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assignment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quiz_8_k8s_concept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quizzes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../add_mat_8_k8s_concept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Additional Materials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary_8_k8s_concept/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#0-create-gke-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      0 Create GKE Cluster
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-kubernetes-features" class="md-nav__link">
    <span class="md-ellipsis">
      1 Kubernetes Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1 Kubernetes Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-using-liveness-probes" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Using Liveness Probes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-using-configmaps" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Using ConfigMaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-using-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Using Secrets
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.3 Using Secrets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-kubernetes-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      1.3.1 Kubernetes Secrets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 Jobs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.4 Jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#141-non-parallel-job" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.1 Non-parallel Job
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#142-parallel-job" class="md-nav__link">
    <span class="md-ellipsis">
      1.4.2 Parallel Job
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-cron-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 Cron Jobs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.5 Cron Jobs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#151-create-cron-job" class="md-nav__link">
    <span class="md-ellipsis">
      1.5.1 Create Cron Job
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-daemon-set" class="md-nav__link">
    <span class="md-ellipsis">
      1.6 Daemon Set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-cleaning-up" class="md-nav__link">
    <span class="md-ellipsis">
      1.7 Cleaning Up
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<p>Lab 8 Kubernetes Features</p>
<p><strong>Objective</strong></p>
<ul>
<li>Use Liveness Probes to healthcheck you application while it is running</li>
<li>Learn about secrets and configmaps</li>
<li>Deploy a Daemonset and jobs</li>
</ul>
<h2 id="0-create-gke-cluster">0 Create GKE Cluster<a class="headerlink" href="#0-create-gke-cluster" title="Permanent link">&para;</a></h2>
<p><strong>Step 1</strong> Enbale the Google Kubernetes Engine API.</p>
<div class="codehilite"><pre><span></span><code>gcloud services enable container.googleapis.com
</code></pre></div>

<p><strong>Step 2</strong> From the cloud shell, run the following command to create a cluster with 1 node:</p>
<div class="codehilite"><pre><span></span><code>gcloud container clusters create k8s-features \
--zone us-central1-c \
--num-nodes 2
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME          LOCATION       MASTER_VERSION   MASTER_IP      MACHINE_TYPE  NODE_VERSION     NUM_NODES  STATUS
k8s-features  us-central1-c  1.19.9-gke.1400  34.121.222.83  e2-medium     1.19.9-gke.1400  2          RUNNING
</code></pre></div>

<p><strong>Step 3</strong> Authenticate to the cluster.</p>
<div class="codehilite"><pre><span></span><code>gcloud container clusters get-credentials k8s-features --zone us-central1-c
</code></pre></div>

<h1 id="1-kubernetes-features">1 Kubernetes Features<a class="headerlink" href="#1-kubernetes-features" title="Permanent link">&para;</a></h1>
<h2 id="11-using-liveness-probes">1.1 Using Liveness Probes<a class="headerlink" href="#11-using-liveness-probes" title="Permanent link">&para;</a></h2>
<p>Many applications running for long periods of time eventually transition to
broken states, and cannot recover except by being restarted. Kubernetes p
rovides liveness probes to detect and remedy such situations.</p>
<p>As we already discussed Kubernetes provides 3 types of <code>Probes</code> to perform
Liveness checks:</p>
<ul>
<li>HTTP GET</li>
<li>EXEC</li>
<li>tcpSocket</li>
</ul>
<p>In below example we are going to use HTTP GET probe for a Pod that runs a container
based on the <code>gcr.io/google_containers/liveness</code> image.</p>
<p>** Step 1** Create <code>http-liveness.yaml</code> manifest with below content:</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt; http-liveness.yaml
apiVersion: v1
kind: Pod
metadata:
  labels:
    test: liveness
  name: liveness-http
spec:
  containers:
  - name: liveness
    image: gcr.io/google_containers/liveness
    args:
    - /server
    livenessProbe:
      httpGet:
        path: /healthz
        port: 8080
        httpHeaders:
        - name: X-Custom-Header
          value: Awesome
      initialDelaySeconds: 3
      periodSeconds: 3
EOF
</code></pre></div>

<p>Based on the manifest, we can see that the Pod has a single Container.
The <code>periodSeconds</code> field specifies that the kubelet should perform a liveness
probe every 3 seconds. The <code>initialDelaySeconds</code> field tells the kubelet that it
should wait 3 seconds before performing the first probe. To perform a probe, the
kubelet sends an HTTP GET request to the server that is running in the Container
and listening on port 8080. If the handler for the server's <code>/healthz</code> path
returns a success code, the kubelet considers the Container to be alive and
healthy. If the handler returns a failure code, the kubelet kills the Container
and restarts it.</p>
<p>Any code greater than or equal to 200 and less than 400 indicates success. Any
other code indicates failure.</p>
<p>Full code for for a reference in  <a href="https://github.com/kubernetes/kubernetes/blob/master/test/images/liveness/server.go">server.go</a>.</p>
<p>For the first 10 seconds that the Container is alive, the <code>/healthz</code> handler
returns a status of 200. After that, the handler returns a status of 500.</p>
<div class="codehilite"><pre><span></span><code><span class="nx">http</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&quot;/healthz&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">w</span><span class="w"> </span><span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">duration</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">().</span><span class="nx">Sub</span><span class="p">(</span><span class="nx">started</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">duration</span><span class="p">.</span><span class="nx">Seconds</span><span class="p">()</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="w">        </span><span class="nx">w</span><span class="p">.</span><span class="nx">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;error: %v&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">duration</span><span class="p">.</span><span class="nx">Seconds</span><span class="p">())))</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">w</span><span class="p">.</span><span class="nx">WriteHeader</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="w">        </span><span class="nx">w</span><span class="p">.</span><span class="nx">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&quot;ok&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">})</span>
</code></pre></div>

<p>The kubelet starts performing health checks 3 seconds after the Container starts.
So the first couple of health checks will succeed. But after 10 seconds, the health
checks will fail, and the kubelet will kill and restart the Container.</p>
<p><strong>Step 2</strong> Let's create a Pod and see how HTTP liveness check works:</p>
<div class="codehilite"><pre><span></span><code>kubectl<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>http-liveness.yaml
</code></pre></div>

<p><strong>Step 3</strong> Monitor the Pod</p>
<div class="codehilite"><pre><span></span><code>watch kubectl get pod
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>After 10 seconds Pods has beed restarted.</p>
</div>
<p>Exit the shell session by using ctrl+c</p>
<p><strong>Step 4</strong> Verify status of the Pod and review the Events happened after restart</p>
<div class="codehilite"><pre><span></span><code>kubectl<span class="w"> </span>describe<span class="w"> </span>pod<span class="w"> </span>liveness-http
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Pod events shows that liveness probes have failed and the Container has been restarted.</p>
</div>
<p><strong>Step 5</strong> Clean up</p>
<div class="codehilite"><pre><span></span><code>kubectl delete -f http-liveness.yaml
</code></pre></div>

<h2 id="12-using-configmaps">1.2 Using ConfigMaps<a class="headerlink" href="#12-using-configmaps" title="Permanent link">&para;</a></h2>
<p>In Kubernetes ConfigMaps could be use in several cases:</p>
<ul>
<li>Storing configuration values as key-values in ConfigMap and referencing them
  in a Pod as environment variables</li>
<li>Storing configurations as a file inside of ConfigMap and referencing it in
  a Pod as a Volume</li>
</ul>
<p>Let's try second option and deploy nginx pod while storing its config in a ConfigMap.</p>
<p><strong>Step 1</strong> Create nginx <code>my-nginx-config.conf</code> config file as below:</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt; my-nginx-config.conf
server {
  listen              80;
  server_name         www.cloudnative.tech;

  gzip on;
  gzip_types text/plain application/xml;

  location / {
    root   /usr/share/nginx/html;
    index  index.html index.htm;
  }
}
EOF
</code></pre></div>

<p><strong>Step 2</strong> Create ConfigMap from this file</p>
<div class="codehilite"><pre><span></span><code>kubectl create configmap nginxconfig --from-file=my-nginx-config.conf
</code></pre></div>

<p><strong>Step 3</strong> Review the ConfigMap</p>
<div class="codehilite"><pre><span></span><code>kubectl describe cm nginxconfig
</code></pre></div>

<p><strong>Result:</strong></p>
<div class="codehilite"><pre><span></span><code>  ```
  Name:     nginxconfig
  Namespace:    default
  Labels:       &lt;none&gt;
  Annotations:  &lt;none&gt;

  Data
  ====
  my-nginx-config.conf:
  ----
  server {
    listen              80;
    server_name         _;

    gzip off;
    gzip_types text/plain application/xml;

    location / {
      root   /usr/share/nginx/html;
      index  index.html index.htm;
    }
  }

  Events:   &lt;none&gt;
  ```
</code></pre></div>

<p><strong>Step 4</strong> Create Nginx Pod <code>website.yaml</code> file, where ConfigMap referenced as a Volume</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt; website.yaml
apiVersion: v1
kind: Pod
metadata:
  name: website
spec:
  containers:
  - image: nginx:alpine
    name: website
    volumeMounts:
    - name: html
      mountPath: /usr/share/nginx/html
      readOnly: false
    - name: config
      mountPath: /etc/nginx/conf.d
      readOnly: true
  volumes:
  - name: html
    emptyDir: {}
  - name: config
    configMap:
      name: nginxconfig
EOF
</code></pre></div>

<p><strong>Step 5</strong> Deploy Nginx Pod <code>website.yaml</code></p>
<div class="codehilite"><pre><span></span><code>kubectl apply -f website.yaml
</code></pre></div>

<p>You can expose a service as we usually do with NodePort or LoadBalancer or by using the port-forward technicque in the next step</p>
<p><strong>Step 6</strong> Open second <code>SSH</code> terminal by pressing "+" icon in the cloud shell and run following command</p>
<div class="codehilite"><pre><span></span><code>kubectl port-forward website 8080:80
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>This opens a tunnel and expose our application on port '80' to localhost:8080.</p>
</div>
<p><strong>Step 7</strong> Test that website is running
Navigate back to the first terminal tab and run the following</p>
<div class="codehilite"><pre><span></span><code>curl localhost:8080
</code></pre></div>

<p><strong>Result:</strong></p>
<div class="codehilite"><pre><span></span><code>  ```
  &lt;html&gt;
  &lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;
  &lt;body&gt;
  &lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;
  &lt;hr&gt;&lt;center&gt;nginx/1.21.0&lt;/center&gt;
  &lt;/body&gt;
  &lt;/html&gt;
  ```
</code></pre></div>

<div class="admonition success">
<p class="admonition-title">Success</p>
<p>You've just learned how to use ConfigMaps.</p>
</div>
<p>You can also use the <code>preview</code> feature with the console</p>
<p><strong>Step 8</strong> start a shell in the pod by using <code>exec</code></p>
<div class="codehilite"><pre><span></span><code>kubectl exec website -it -- sh
</code></pre></div>

<p>Your terminal now should have <code>/#</code></p>
<p><strong>Step 9</strong> view the content of the folder where we added the volume</p>
<div class="codehilite"><pre><span></span><code>ls /etc/nginx/conf.d
</code></pre></div>

<p><strong>Step 10</strong> check the content of the file in that folder and notice that it's the same as the config file for nginx we mounted.</p>
<div class="codehilite"><pre><span></span><code>cat /etc/nginx/conf.d/my-nginx-config.conf
</code></pre></div>

<p><strong>Step 11</strong> Exit the shell</p>
<div class="codehilite"><pre><span></span><code>exit
</code></pre></div>

<p>Make sure you're back to the cloud shell terminal.</p>
<h2 id="13-using-secrets">1.3 Using Secrets<a class="headerlink" href="#13-using-secrets" title="Permanent link">&para;</a></h2>
<h3 id="131-kubernetes-secrets">1.3.1 Kubernetes Secrets<a class="headerlink" href="#131-kubernetes-secrets" title="Permanent link">&para;</a></h3>
<p>Kubernetes secrets allow users to define sensitive information outside of containers and expose that information to containers through environment variables as well as files within Pods. In this section we will declare and create secrets to hold our database connection information that will be used by Wordpress to connect to its backend database.</p>
<p><strong>Step 1</strong> Open up two terminal windows. We will use one window to generate encoded strings that will contain our sensitive data. The other window will be used to create the secrets YAML declaration.</p>
<p><strong>Step 2</strong> In the first terminal window, execute the following commands to encode our strings:</p>
<div class="codehilite"><pre><span></span><code>echo -n &quot;admin&quot; | base64
echo -n &quot;t0p-Secret&quot; | base64
</code></pre></div>

<p><strong>Step 3</strong> create the secret. For this lab, we added the encoded values for you. Feel free to change the username and password, and replace the values in the file below:</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt; app-secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: app-secret
type: Opaque
data:
  username: YWRtaW4=
  password: dDBwLVNlY3JldA==
EOF
</code></pre></div>

<p><strong>Step 4</strong> Create the secret:</p>
<div class="codehilite"><pre><span></span><code>kubectl create -f app-secrets.yaml
</code></pre></div>

<p><strong>Step 5</strong> Verify secret creation and get details:</p>
<div class="codehilite"><pre><span></span><code>kubectl get secrets
</code></pre></div>

<p><strong>Step 6</strong> Get details of this secret:</p>
<div class="codehilite"><pre><span></span><code>kubectl describe secrets/app-secrets
</code></pre></div>

<p><strong>Result:</strong></p>
<div class="codehilite"><pre><span></span><code>Name:         app-secret
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;

Type:  Opaque

Data
====
password:  10 bytes
username:  5 bytes
</code></pre></div>

<p><strong>Step 7</strong> Create a pod that will reference the secret as a volume.
Use either nano or vim to create secret-pod.yaml, and copy the following to it</p>
<div class="codehilite"><pre><span></span><code>apiVersion: v1
kind: Pod
metadata:
  name: secret-test-pod
spec:
  containers:
    - name: test-container
      image: alpine
      command: [&quot;/bin/sh&quot;, &quot;-ec&quot;, &quot;export LOGIN=$(cat /etc/secret-volume/username);export PWD=$(cat /etc/secret-volume/password);while true; do echo hello $LOGIN your password is $PWD; sleep 10; done&quot;]
      volumeMounts:
          - name: secret-volume
            mountPath: /etc/secret-volume
  volumes:
    - name: secret-volume
      secret:
        secretName: app-secret
  restartPolicy: Never
</code></pre></div>

<p><strong>Step 8</strong> View the logs of the pod.</p>
<div class="codehilite"><pre><span></span><code>kubectl logs secret-test-pod
</code></pre></div>

<p>Notice how we were able to pull the content of the secret using a command. Not very secure, right?</p>
<p><strong>Step 9</strong> Delete both the pod and the secret</p>
<div class="codehilite"><pre><span></span><code>kubectl delete pod secret-test-pod
kubectl delete secret app-secret
</code></pre></div>

<div class="admonition summary">
<p class="admonition-title">Summary</p>
<p>Secrets has been created and they not visiable when you view them via
<code>kubectl describe</code> This does not make Kubernetes secrets secure as we have experienced. Additonal measures need to be in place to protect secrets.</p>
</div>
<h2 id="14-jobs">1.4 Jobs<a class="headerlink" href="#14-jobs" title="Permanent link">&para;</a></h2>
<p>A Job creates one or more pods and ensures that a specified number of them successfully complete. A job keeps track of successful completion of a pod. When the specified number of pods have successfully completed, the job itself is complete. The job will start a new pod if the pod fails or is deleted due to hardware failure. A successful completion of the specified number of pods means the job is complete.</p>
<p>This is different from a replica set or a deployment which ensures that a certain number of pods are always running. So if a pod in a replica set or deployment terminates, then it is restarted again. This makes replica set or deployment as long-running processes. This is well suited for a web server, such as NGINX. But a job is completed if the specified number of pods successfully completes. This is well suited for tasks that need to run only once. For example, a job may convert an image format from one to another. Restarting this pod in replication controller would not only cause redundant work but may be harmful in certain cases.</p>
<p>Jobs are complementary to Replica Set. A Replica Set manages pods which are not expected to terminate (e.g. web servers), and a Job manages pods that are expected to terminate (e.g. batch jobs).</p>
<h3 id="141-non-parallel-job">1.4.1 Non-parallel Job<a class="headerlink" href="#141-non-parallel-job" title="Permanent link">&para;</a></h3>
<p>Only one pod per job is started, unless the pod fails. Job is complete as soon as the pod terminates successfully.</p>
<p>Use the image "busybox" and have it sleep for 10 seconds and then complete.
Run your job to be sure it works.</p>
<p><strong>Step 1</strong> Create a Job Manifest</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt; busybox.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: busybox
spec:
  template:
    spec:
      containers:
      - name: busybox
        image: busybox
        command: [&quot;sleep&quot;, &quot;20&quot;]
      restartPolicy: Never
EOF
</code></pre></div>

<p><strong>Step 2</strong> Run a Job</p>
<div class="codehilite"><pre><span></span><code>kubectl create -f busybox.yaml
</code></pre></div>

<p><strong>Step 3</strong> Look at the job:</p>
<div class="codehilite"><pre><span></span><code>kubectl get jobs
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME      DESIRED   SUCCESSFUL   AGE
busybox    1         0            0s
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>The output shows that the job is not successful yet.</p>
</div>
<p><strong>Step 4</strong> Watch the pod status</p>
<div class="codehilite"><pre><span></span><code>kubectl get -w pods
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME         READY     STATUS    RESTARTS   AGE
busybox-lk49x   1/1       Running   0          7s
busybox-lk49x   0/1       Completed   0         24s
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>It starts with pod for the job is <code>Running</code>.
Then pod successfully exits after a few seconds and shows the <code>Completed</code> status.</p>
</div>
<p><strong>Step 5</strong> Watch the job status again:</p>
<div class="codehilite"><pre><span></span><code>kubectl get jobs
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME      COMPLETIONS   DURATION   AGE
busybox   1/1           21s        1m
</code></pre></div>

<p><strong>Step 6</strong> Delete a Job</p>
<div class="codehilite"><pre><span></span><code>kubectl delete -f busybox.yaml
</code></pre></div>

<h3 id="142-parallel-job">1.4.2 Parallel Job<a class="headerlink" href="#142-parallel-job" title="Permanent link">&para;</a></h3>
<p>Non-parallel jobs run only one pod per job. This API is used to run multiple pods in parallel for the job. The number of pods to complete is defined by <code>.spec.completions</code> attribute in the configuration file. The number of pods to run in parallel is defined by <code>.spec.parallelism</code> attribute in the configuration file. The default value for both of these attributes is 1.</p>
<p>The job is complete when there is one successful pod for each value in the range in 1 to <code>.spec.completions</code>. For that reason, it is also called as <em>fixed completion count</em> job.</p>
<p><strong>Step 1</strong> Create a Job Manifest</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt; job-parallel.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: wait
spec:
  completions: 6
  parallelism: 2
  template:
    metadata:
      name: wait
    spec:
      containers:
      - name: wait
        image: ubuntu
        command: [&quot;sleep&quot;,  &quot;10&quot;]
      restartPolicy: Never
EOF
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This job specification is similar to the non-parallel job specification above.
However it has two new attributes added: <code>.spec.completions</code> and <code>.spec.parallelism</code>.
This means the job will be complete when six pods have successfully completed.
A maximum of two pods will run in parallel at a given time.</p>
</div>
<p><strong>Step 2</strong> Create a parallel job using the command:</p>
<div class="codehilite"><pre><span></span><code>kubectl apply -f job-parallel.yaml
</code></pre></div>

<p><strong>Step 3</strong> Watch the status of the job as shown:</p>
<div class="codehilite"><pre><span></span><code>kubectl get -w jobs
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME   COMPLETIONS   DURATION   AGE
wait   0/6           6s         6s
wait   1/6           12s        12s
wait   2/6           12s        12s
wait   3/6           24s        24s
wait   4/6           24s        24s
wait   5/6           36s        36s
wait   6/6           36s        36s
</code></pre></div>

<div class="admonition results">
<p class="admonition-title">Results</p>
<p>The output shows that 2 pods are created about every 12 seconds.</p>
</div>
<p><strong>Step 4</strong>  In another terminal window, watch the status of pods created:</p>
<div class="codehilite"><pre><span></span><code>kubectl get -w pods -l job-name=wait
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME         READY   STATUS      RESTARTS   AGE
wait-5blwm   0/1     Completed   0          17s
wait-stmk4   0/1     Completed   0          17s
wait-ts6xt   1/1     Running     0          5s
wait-xlhl6   1/1     Running     0          5s
wait-xlhl6   0/1     Completed   0          12s
wait-rq6z5   0/1     Pending     0          0s
wait-ts6xt   0/1     Completed   0          12s
wait-rq6z5   0/1     Pending     0          0s
wait-rq6z5   0/1     ContainerCreating   0          0s
wait-f85bj   0/1     Pending             0          0s
wait-f85bj   0/1     Pending             0          0s
wait-f85bj   0/1     ContainerCreating   0          0s
wait-rq6z5   1/1     Running             0          2s
wait-f85bj   1/1     Running             0          2s
wait-f85bj   0/1     Completed           0          12s
wait-rq6z5   0/1     Completed           0          12s
</code></pre></div>

<p><strong>Step 6</strong> Once the job is completed, you can get the list of completed pods</p>
<div class="codehilite"><pre><span></span><code>kubectl get pods -l job-name=wait
</code></pre></div>

<p>Result:</p>
<div class="codehilite"><pre><span></span><code>NAME         READY   STATUS      RESTARTS   AGE
wait-5blwm   0/1     Completed   0          2m55s
wait-f85bj   0/1     Completed   0          2m31s
wait-rq6z5   0/1     Completed   0          2m31s
wait-stmk4   0/1     Completed   0          2m55s
wait-ts6xt   0/1     Completed   0          2m43s
wait-xlhl6   0/1     Completed   0          2m43s
</code></pre></div>

<p><strong>Step 5</strong> Similarly, <code>kubectl get jobs</code> shows the status of the job after it
has completed:</p>
<div class="codehilite"><pre><span></span><code>kubectl get jobs
</code></pre></div>

<p>Result:</p>
<div class="codehilite"><pre><span></span><code>NAME   COMPLETIONS   DURATION   AGE
wait   6/6           36s        3m54s
</code></pre></div>

<p><strong>Step 6</strong> Deleting a job deletes all the pods as well. Delete the job as:</p>
<div class="codehilite"><pre><span></span><code>kubectl delete -f job-parallel.yaml
</code></pre></div>

<h2 id="15-cron-jobs">1.5 Cron Jobs<a class="headerlink" href="#15-cron-jobs" title="Permanent link">&para;</a></h2>
<p>A Cron Job is a job that runs on a given schedule, written in Cron format.
There are two primary use cases:</p>
<ul>
<li>Run jobs once at a specified point in time</li>
<li>Repeatedly at a specified point in time</li>
</ul>
<h3 id="151-create-cron-job">1.5.1 Create Cron Job<a class="headerlink" href="#151-create-cron-job" title="Permanent link">&para;</a></h3>
<p><strong>Step 1</strong> Create <code>CronJob</code> manifest that prints the current timestamp and the
message "<code>Hello World</code>" every minute.</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt; cronjob.yaml
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: &quot;*/1 * * * *&quot;
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            app: hello-cronpod
        spec:
          containers:
          - name: hello
            image: busybox
            args:
            - /bin/sh
            - -c
            - date; echo Hello World!
          restartPolicy: OnFailure
EOF
</code></pre></div>

<p><strong>Step 2</strong> Create the Cron Job as shown in the command:</p>
<div class="codehilite"><pre><span></span><code>kubectl create -f cronjob.yaml
</code></pre></div>

<p><strong>Step 3</strong> Watch the status of the job as shown:</p>
<div class="codehilite"><pre><span></span><code>kubectl get -w cronjobs
</code></pre></div>

<p><strong>Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>NAME    SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE
hello   */1 * * * *   False     0        &lt;none&gt;          6s
hello   */1 * * * *   False     1        5s              39s
hello   */1 * * * *   False     0        15s             49s
hello   */1 * * * *   False     1        5s              99s
hello   */1 * * * *   False     0        15s             109s
hello   */1 * * * *   False     1        6s              2m40s
hello   */1 * * * *   False     0        16s             2m50s
</code></pre></div>

<p><strong>Step 4</strong> In another terminal window, watch the status of pods created:</p>
<div class="codehilite"><pre><span></span><code>kubectl get -w pods -l app=hello-cronpod
</code></pre></div>

<p><strong>Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>NAME                     READY   STATUS      RESTARTS   AGE
hello-1622584020-kc46c   0/1     Completed   0          118s
hello-1622584080-c2pcq   0/1     Completed   0          58s
hello-1622584140-hxnv2   0/1     Pending     0          0s
hello-1622584140-hxnv2   0/1     Pending     0          0s
hello-1622584140-hxnv2   0/1     ContainerCreating   0          0s
hello-1622584140-hxnv2   1/1     Running             0          1s
hello-1622584140-hxnv2   0/1     Completed           0          2s
</code></pre></div>

<p><strong>Step 5</strong> Get logs from one of the pods:</p>
<div class="codehilite"><pre><span></span><code>kubectl logs hello-1622584140-hxnv2
</code></pre></div>

<p><strong>Output</strong>:</p>
<div class="codehilite"><pre><span></span><code>Tue Jun  1 21:49:07 UTC 2021
Hello World!
</code></pre></div>

<p><strong>Step 6</strong> Delete Cron Job</p>
<div class="codehilite"><pre><span></span><code>kubectl delete -f cronjob.yaml
</code></pre></div>

<h2 id="16-daemon-set">1.6 Daemon Set<a class="headerlink" href="#16-daemon-set" title="Permanent link">&para;</a></h2>
<p>Daemon Set ensures that a copy of the pod runs on a selected set of nodes.
By default, all nodes in the cluster are selected. A selection critieria may be
specified to select a limited number of nodes.</p>
<p>As new nodes are added to the cluster, pods are started on them. As nodes are
removed, pods are removed through garbage collection.</p>
<p>The following is an example DaemonSet that runs a Prometheus exporter container
that used for collecting machine metrics from each node.</p>
<p><strong>Step 1</strong> Create a DaemonSet manifest</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt; daemonset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: prometheus-daemonset
spec:
  selector:
    matchLabels:
      tier: monitoring
      name: prometheus-exporter
  template:
    metadata:
      labels:
        tier: monitoring
        name: prometheus-exporter
    spec:
      containers:
      - name: prometheus
        image: prom/node-exporter
        ports:
        - containerPort: 80
EOF
</code></pre></div>

<p><strong>Step 2</strong>  Run the following command to create the ReplicaSet and pods:</p>
<div class="codehilite"><pre><span></span><code>kubectl create -f daemonset.yaml --record
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>--record</code> flag will track changes made through each revision.</p>
</div>
<p><strong>Step 3</strong> Get basic details about the DaemonSet:</p>
<div class="codehilite"><pre><span></span><code>kubectl get daemonsets/prometheus-daemonset
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME                   DESIRED   CURRENT   READY     UP-TO-DATE   AVAILABLE   NODE-SELECTOR   AGE
prometheus-daemonset   1         1         1         1            1           &lt;none&gt;          5s
</code></pre></div>

<p><strong>Step 4</strong> Get more details about the DaemonSet:</p>
<div class="codehilite"><pre><span></span><code>kubectl describe daemonset/prometheus-daemonset
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>Name:           prometheus-daemonset
Selector:       name=prometheus-exporter,tier=monitoring
Node-Selector:  &lt;none&gt;
Labels:         &lt;none&gt;
Annotations:    deprecated.daemonset.template.generation: 1
                kubernetes.io/change-cause: kubectl create --filename=daemonset.yaml --record=true
Desired Number of Nodes Scheduled: 2
Current Number of Nodes Scheduled: 2
Number of Nodes Scheduled with Up-to-date Pods: 2
Number of Nodes Scheduled with Available Pods: 2
Number of Nodes Misscheduled: 0
Pods Status:  2 Running / 0 Waiting / 0 Succeeded / 0 Failed
Pod Template:
  Labels:  name=prometheus-exporter
           tier=monitoring
  Containers:
   prometheus:
    Image:        prom/node-exporter
    Port:         80/TCP
    Host Port:    0/TCP
    Environment:  &lt;none&gt;
    Mounts:       &lt;none&gt;
  Volumes:        &lt;none&gt;
Events:
  Type    Reason            Age    From                  Message
  ----    ------            ----   ----                  -------
  Normal  SuccessfulCreate  9m     daemonset-controller  Created pod: prometheus-daemonset-f4xl2
  Normal  SuccessfulCreate  2m18s  daemonset-controller  Created pod: prometheus-daemonset-w596z
</code></pre></div>

<p><strong>Step 5</strong> Get pods in the DaemonSet:</p>
<div class="codehilite"><pre><span></span><code>kubectl get pods -l name=prometheus-exporter
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME                         READY   STATUS    RESTARTS   AGE
prometheus-daemonset-f4xl2   1/1     Running   0          8m27s
prometheus-daemonset-w596z   1/1     Running   0          105s
</code></pre></div>

<p><strong>Step 6</strong> Verify that the Prometheus pod was successfully deployed to the cluster nodes:</p>
<div class="codehilite"><pre><span></span><code>kubectl get pods -o wide
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME                         READY   STATUS    RESTARTS   AGE     IP          NODE                                          NOMINATED NODE   READINESS GATES
prometheus-daemonset-f4xl2   1/1     Running   0          6m51s   10.0.0.19   gke-k8s-features-default-pool-73e09df7-m2lf   &lt;none&gt;           &lt;none&gt;
prometheus-daemonset-w596z   1/1     Running   0          9s      10.0.1.2    gke-k8s-features-default-pool-73e09df7-k7hj   &lt;none&gt;           &lt;none&gt;
</code></pre></div>

<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>It is possible to Limit DaemonSets to specific nodes
by changing the <code>spec.template.spec</code> to include a <code>nodeSelector</code> to matche <code>node</code> label.</p>
</div>
<p><strong>Step 7</strong>  Delete a DaemonSet</p>
<div class="codehilite"><pre><span></span><code>kubectl delete -f daemonset.yaml
</code></pre></div>

<h2 id="17-cleaning-up">1.7 Cleaning Up<a class="headerlink" href="#17-cleaning-up" title="Permanent link">&para;</a></h2>
<p><strong>Step 1</strong> Delete the cluster</p>
<div class="codehilite"><pre><span></span><code>gcloud container clusters delete k8s-concepts
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/googlecloud" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>