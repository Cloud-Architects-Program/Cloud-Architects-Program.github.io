
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.3">
    
    
      
        <title>ycit019 Lab 4 Docker Images Docker Hub Quya io - YCIT020</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e35208c4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-building-docker-images" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="YCIT020" class="md-header__button md-logo" aria-label="YCIT020" data-md-component="logo">
      
  <img src="../images/k8s.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            YCIT020
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ycit019 Lab 4 Docker Images Docker Hub Quya io
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="YCIT020" class="md-nav__button md-logo" aria-label="YCIT020" data-md-component="logo">
      
  <img src="../images/k8s.svg" alt="logo">

    </a>
    YCIT020
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        YCIT020
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="YCIT020" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          YCIT020
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      <label class="md-nav__link" for="__nav_2_1">
        Labs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Labs" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Labs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Lab_3_Terraform_Fundamentals/" class="md-nav__link">
        Lab 3 Terraform Fundamentals
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Lab_4_Traffic_control/" class="md-nav__link">
        Lab 4 Traffic Management
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Lab_5_EFK/" class="md-nav__link">
        Lab 5 EFK Stack
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      <label class="md-nav__link" for="__nav_2_2">
        Assignments
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Assignments" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Assignments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_2_Production_GKE/" class="md-nav__link">
        Assignment2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_2_sol_Production_GKE/" class="md-nav__link">
        Assignment2 Sol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_3_Terraform_GCP_Foundation/" class="md-nav__link">
        Assignment3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_3_sol_Terraform_GCP_Foundation/" class="md-nav__link">
        Assignment3 Sol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_4_Helm_Foundation/" class="md-nav__link">
        Assignmen4
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_4_sol_Helm_Foundation/" class="md-nav__link">
        Assignmen4 Sol
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        YCIT019
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="YCIT019" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          YCIT019
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      <label class="md-nav__link" for="__nav_3_1">
        Labs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Labs" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Labs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_2_Docker_basics/" class="md-nav__link">
        Lab 2 Docker Basics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_3_Advanced_Docker/" class="md-nav__link">
        Lab 3 Advanced Docker
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_4_Docker_Images/" class="md-nav__link">
        Lab 4 Managing Docker Images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_5_Docker_Compose/" class="md-nav__link">
        Lab 5 Docker Compose
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_6_Deploy_Kubernetes_kubeadm/" class="md-nav__link">
        Lab 6 Deploy Kubernetes Cluster with Kubeadm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_7_Kubernetes_Concepts/" class="md-nav__link">
        Lab 7 Kubernetes Concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_8_Kubernetes_Features/" class="md-nav__link">
        Lab 8 Kubernetes Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_9_Kubernetes_Scaling/" class="md-nav__link">
        Lab 9 Kubernetes Autoscaling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_10_Networking/" class="md-nav__link">
        Lab 10 Kubernetes Networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_11_Storage/" class="md-nav__link">
        Lab 11 Kubernetes Storage
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Assignments
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Assignments" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Assignments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass1/" class="md-nav__link">
        Assignment1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass1_sol/" class="md-nav__link">
        Assignment1 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass2/" class="md-nav__link">
        Assignment2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass2_solution/" class="md-nav__link">
        Assignment2 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass3/" class="md-nav__link">
        Assignment3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass3_solution/" class="md-nav__link">
        Assignment3 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass4/" class="md-nav__link">
        Assignment4
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass4_sol/" class="md-nav__link">
        Assignment4 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass5/" class="md-nav__link">
        Assignment5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass5_solution/" class="md-nav__link">
        Assignment5 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass6/" class="md-nav__link">
        Assignment6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass6_solution/" class="md-nav__link">
        Assignment6 - Solution
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#11-create-dockerfile" class="md-nav__link">
    1.1 Create DOCKERFILE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-build-a-docker-image" class="md-nav__link">
    1.2 Build a Docker image
  </a>
  
    <nav class="md-nav" aria-label="1.2 Build a Docker image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-share-docker-images-with-tar-files" class="md-nav__link">
    1.2.1 Share docker images with tar files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-publish-docker-image-to-docker-hub" class="md-nav__link">
    1.2.2 Publish Docker Image to Docker Hub
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123-automated-builds-with-docker-cloud" class="md-nav__link">
    1.2.3 Automated Builds with Docker Cloud
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124-push-docker-images-to-quayio" class="md-nav__link">
    1.2.4 Push Docker Images to quay.io
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#125-demo-quayio" class="md-nav__link">
    1.2.5 Demo quay.io
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <p>Lab 4 Managing Docker Images</p>
<p><strong>Objective:</strong></p>
<ul>
<li>Learn to build docker images using Dockerfiles.</li>
<li>Store images in Docker Hub</li>
<li>Learn alternative registry solutions (Quya.io)</li>
<li>Automate image build process with Docker Cloud</li>
</ul>
<h1 id="1-building-docker-images">1 Building Docker Images<a class="headerlink" href="#1-building-docker-images" title="Permanent link">&para;</a></h1>
<p>In the previous modules, we learned how to use Docker images
to run Docker containers. Docker images that we used have been downloaded from
the Docker Hub, a registry of Docker images. In this section we will create a
simple web application from scratch. We will use Flask
(<a href="http://flask.pocoo.org/">http://flask.pocoo.org/</a>), a microframework for
Python. Our application for each request will display a random picture from the
defined set.</p>
<p>In the next session we will create all necessary files for our application,
build docker image and then push to Docker Hub and Quay.</p>
<p>The code for this application is also available in GitHub:</p>
<div class="codehilite"><pre><span></span><code>git clone https://github.com/archyufa/k8scanada
</code></pre></div>

<h2 id="11-create-dockerfile">1.1 Create DOCKERFILE<a class="headerlink" href="#11-create-dockerfile" title="Permanent link">&para;</a></h2>
<p><strong>Step 1</strong> Clone git repo on you laptop:</p>
<div class="codehilite"><pre><span></span><code>git clone https://github.com/archyufa/k8scanada
cd k8scanada/Module4/flask-app/
</code></pre></div>

<p><strong>Step 2</strong> In this directory, we see following files:</p>
<div class="codehilite"><pre><span></span><code>flask-app/
    Dockerfile
    app.py
    requirements.txt
    templates/
        index.html
</code></pre></div>

<p><strong>Step 3</strong> Let’s review file app.py with the following content:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># list of cat images</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr05/15/9/anigif_enhanced-buzz-26388-1381844103-11.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr01/15/9/anigif_enhanced-buzz-31540-1381844535-8.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr05/15/9/anigif_enhanced-buzz-26390-1381844163-18.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr06/15/10/anigif_enhanced-buzz-1376-1381846217-0.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr03/15/9/anigif_enhanced-buzz-3391-1381844336-26.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr06/15/10/anigif_enhanced-buzz-29111-1381845968-0.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr03/15/9/anigif_enhanced-buzz-3409-1381844582-13.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr02/15/9/anigif_enhanced-buzz-19667-1381844937-10.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr05/15/9/anigif_enhanced-buzz-26358-1381845043-13.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr06/15/9/anigif_enhanced-buzz-18774-1381844645-6.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr06/15/9/anigif_enhanced-buzz-25158-1381844793-0.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://ak-hdl.buzzfed.com/static/2013-10/enhanced/webdr03/15/10/anigif_enhanced-buzz-11980-1381846269-1.gif&quot;</span>
<span class="p">]</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>Step 4</strong> Below is the content of requirements.txt file:</p>
<div class="codehilite"><pre><span></span><code>Flask==0.10.1
</code></pre></div>

<p><strong>Step 5</strong> Under directory templates observe index.html with the following
content:</p>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
      <span class="nt">body</span> <span class="p">{</span>
        <span class="k">background</span><span class="p">:</span> <span class="kc">black</span><span class="p">;</span>
        <span class="k">color</span><span class="p">:</span> <span class="kc">white</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">div</span><span class="p">.</span><span class="nc">container</span> <span class="p">{</span>
        <span class="k">max-width</span><span class="p">:</span> <span class="mi">500</span><span class="kt">px</span><span class="p">;</span>
        <span class="k">margin</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span> <span class="kc">auto</span><span class="p">;</span>
        <span class="k">border</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span> <span class="kc">solid</span> <span class="kc">white</span><span class="p">;</span>
        <span class="k">padding</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
        <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">h4</span> <span class="p">{</span>
        <span class="k">text-transform</span><span class="p">:</span> <span class="kc">uppercase</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span>Cat Gif of the day<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;{{url}}&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<p><strong>Step 6</strong> Let’s review content of the Dockerfile:</p>
<div class="codehilite"><pre><span></span><code><span class="c"># our base image</span>
<span class="k">FROM</span> <span class="s">alpine:3.5</span>

<span class="c"># Install python and pip</span>
<span class="k">RUN</span> apk add --update py2-pip

<span class="c"># upgrade pip</span>
<span class="k">RUN</span> pip install --upgrade pip

<span class="c"># install Python modules needed by the Python app</span>
<span class="k">COPY</span> requirements.txt /usr/src/app/
<span class="k">RUN</span> pip install --no-cache-dir -r /usr/src/app/requirements.txt

<span class="c"># copy files required for the app to run</span>
<span class="k">COPY</span> app.py /usr/src/app/
<span class="k">COPY</span> templates/index.html /usr/src/app/templates/

<span class="c"># tell the port number the container should expose</span>
<span class="k">EXPOSE</span><span class="s"> 5000</span>

<span class="c"># run the application</span>
<span class="k">CMD</span> <span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span> <span class="s2">&quot;/usr/src/app/app.py&quot;</span><span class="p">]</span>
</code></pre></div>

<h2 id="12-build-a-docker-image">1.2 Build a Docker image<a class="headerlink" href="#12-build-a-docker-image" title="Permanent link">&para;</a></h2>
<p><strong>Step 1</strong> Now let’s build our Docker image. In the command below, replace
<user-name> with your user name. This user name should be the same as you
created when you registered on Docker Hub. Because we will publish our build
image in the next step.</p>
<div class="codehilite"><pre><span></span><code>docker build -t &lt;user-name&gt;/myfirstapp .
</code></pre></div>

<p><strong>Step 2</strong> Where is your built image? It’s in your machine’s local Docker image
registry, you can
check that your image exists with command below:</p>
<div class="codehilite"><pre><span></span><code>docker images
</code></pre></div>

<p><strong>Step 3</strong> Now run a container in a background and expose a standard HTTP port
(80), which is redirected to the container’s port 5000:</p>
<div class="codehilite"><pre><span></span><code>docker run -dp 80:5000 --name myfirstapp &lt;user-name&gt;/myfirstapp
</code></pre></div>

<p><strong>Step 4</strong> Use your browser to open the address http://<VM or Laptop IP> and
check that the application works.</p>
<p><strong>Step 5</strong> Stop the container and remove it:</p>
<div class="codehilite"><pre><span></span><code>docker stop myfirstapp

docker rm myfirstapp
myfirstapp
</code></pre></div>

<h3 id="121-share-docker-images-with-tar-files">1.2.1 Share docker images with tar files<a class="headerlink" href="#121-share-docker-images-with-tar-files" title="Permanent link">&para;</a></h3>
<p>Now ideally you want to share you freshly build docker image with someone or
run it in different environment which for some reason don’t have internet access
so images can not be pulled from Online Docker registries. In that case Docker
images can be shared as we share traditionally regular files by creating
<strong>tarballs</strong>  using docker save  command as following</p>
<p><strong>Step 1</strong> Create a tar file using docker save  command:</p>
<div class="codehilite"><pre><span></span><code>docker save &lt;user-name&gt;/myfirstapp &gt; myfirstapp.tar
</code></pre></div>

<p>Or</p>
<div class="codehilite"><pre><span></span><code>docker save --output myfirstapp1.tar archyufa/myfirstapp
ls -trh | grep tar
</code></pre></div>

<p><strong>Step 2</strong> Transfer images to another environment using scp command.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You can also store this images in Object storages, e.g. Swift or
Amazon S3 using version control.</p>
</div>
<p><strong>Step 3</strong> Now you can restore this images using docker load, that will load a
tarred repository from a file or the standard input stream. It restores both
images and tags.</p>
<div class="codehilite"><pre><span></span><code>docker load &lt; myfirstapp.tar
</code></pre></div>

<div class="codehilite"><pre><span></span><code>23b9c7b43573: Loading layer [==================================================&gt;]   4.23MB/4.23MB

b3b5c1214f71: Loading layer [==================================================&gt;]  52.87MB/52.87MB

f877d8dd64d3: Loading layer [==================================================&gt;]  8.636MB/8.636MB

bba871f91589: Loading layer [==================================================&gt;]  3.584kB/3.584kB

1c131e92eb5f: Loading layer [==================================================&gt;]  5.053MB/5.053MB

3f6463bcb64c: Loading layer [==================================================&gt;]   5.12kB/5.12kB

47c61110467a: Loading layer [==================================================&gt;]  4.096kB/4.096kB

Loaded image: archyufa/myfirstapp:latest
</code></pre></div>

<div class="codehilite"><pre><span></span><code>docker images
</code></pre></div>

<h3 id="122-publish-docker-image-to-docker-hub">1.2.2 Publish Docker Image to Docker Hub<a class="headerlink" href="#122-publish-docker-image-to-docker-hub" title="Permanent link">&para;</a></h3>
<p>However the most popular way to share and work with you images is to push
them to the Docker Hub.</p>
<p><strong>Docker Hub</strong> is a <a href="https://hub.docker.com/explore/">registry</a>
of Docker images. You can think of the registry as a directory of all available
Docker images.</p>
<p><strong>Step 1 (Optional)</strong> If you don’t have a Docker account, sign up for one
<a href="https://hub.docker.com/">here</a>. Make a note of your username and password.</p>
<p><strong>Step 2</strong> Log in to your local machine.</p>
<div class="codehilite"><pre><span></span><code>docker login
</code></pre></div>

<p><strong>Step 3</strong> Now, publish your image to docker Hub.</p>
<div class="codehilite"><pre><span></span><code>docker push &lt;user-name&gt;/myfirstapp
</code></pre></div>

<p><strong>Step 4</strong> Login to <a href="https://hub.docker.com">https://hub.docker.com</a> and verify
simage and tags.</p>
<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Image been pushed and can be observed in Docker Hub, with the <strong>tag</strong> latest.</p>
</div>
<p><strong>Step 5</strong> It is also possible to specify a custom tag for image prior to push
it to the registry</p>
<div class="codehilite"><pre><span></span><code>docker tag 5b45ce063cea &lt;user-name&gt;/myfirstapp:v1
docker push &lt;user-name&gt;/myfirstapp:v1
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Image been pushed and can be observed in Docker Hub. You can now
observe 2 docker image one with the <strong>tag</strong> latest and another with tag v1</p>
</div>
<p><strong>Step 6</strong> You can now <strong>pull</strong> or <strong>run</strong> specified <strong>Docker images</strong> from any
other location where docker engine is installed with following commands:</p>
<div class="codehilite"><pre><span></span><code>docker pull &lt;user-name&gt;/myfirstapp:latest

docker pull &lt;user-name&gt;/myfirstapp:v1
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Images stored locally</p>
</div>
<div class="codehilite"><pre><span></span><code>docker images
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>myfirstapp       v1       f50f9524513f    1 hour ago   22 MB

myfirstapp       latest   f50f9524513f    1 hour ago   22 MB
</code></pre></div>

<p>Finally run images with specific tag:</p>
<div class="codehilite"><pre><span></span><code>docker run &lt;user-name&gt;/myfirstapp:v1
</code></pre></div>

<h3 id="123-automated-builds-with-docker-cloud">1.2.3 Automated Builds with Docker Cloud<a class="headerlink" href="#123-automated-builds-with-docker-cloud" title="Permanent link">&para;</a></h3>
<p><strong>Live Demo:</strong></p>
<ul>
<li>Docker Security scanning</li>
<li>Setting Up Auto-Build in Docker Cloud and notifications to slac</li>
<li>Automated Tests with PR</li>
</ul>
<h3 id="124-push-docker-images-to-quayio">1.2.4 Push Docker Images to quay.io<a class="headerlink" href="#124-push-docker-images-to-quayio" title="Permanent link">&para;</a></h3>
<p><strong>Prerequisite:</strong> Register to  quay.io with your Github user</p>
<p><strong>Step 1</strong> Login to quay.io from CLI</p>
<div class="codehilite"><pre><span></span><code>docker login quay.io
</code></pre></div>

<p><strong>Step 2</strong> Build image with quay prefix</p>
<div class="codehilite"><pre><span></span><code>docker build -t quay.io/archyufa/myfirstapp .
</code></pre></div>

<p><strong>Step 3</strong> Push image to quay registry</p>
<div class="codehilite"><pre><span></span><code>docker push quay.io/archyufa/myfirstapp
</code></pre></div>

<h3 id="125-demo-quayio">1.2.5 Demo quay.io<a class="headerlink" href="#125-demo-quayio" title="Permanent link">&para;</a></h3>
<p><strong>Live Demo:</strong></p>
<ul>
<li>Docker Security scanning</li>
<li>Setting Up Auto-Build in Docker Cloud / Quai.io</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/googlecloud" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>