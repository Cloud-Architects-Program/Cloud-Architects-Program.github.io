
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.3">
    
    
      
        <title>020 Assignment 3 sol Terraform GCP Foundation - YCIT020</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e35208c4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#working-with-git-and-iac" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="YCIT020" class="md-header__button md-logo" aria-label="YCIT020" data-md-component="logo">
      
  <img src="../images/k8s.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            YCIT020
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              020 Assignment 3 sol Terraform GCP Foundation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="YCIT020" class="md-nav__button md-logo" aria-label="YCIT020" data-md-component="logo">
      
  <img src="../images/k8s.svg" alt="logo">

    </a>
    YCIT020
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        YCIT020
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="YCIT020" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          YCIT020
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      <label class="md-nav__link" for="__nav_2_1">
        Labs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Labs" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Labs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Lab_3_Terraform_Fundamentals/" class="md-nav__link">
        Lab 3 Terraform Fundamentals
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      <label class="md-nav__link" for="__nav_2_2">
        Assignments
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Assignments" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Assignments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_2_Production_GKE/" class="md-nav__link">
        Assignment2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_2_sol_Production_GKE/" class="md-nav__link">
        Assignment2 Sol
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../020_Assignment_3_Terraform_GCP_Foundation/" class="md-nav__link">
        Assignment3
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        YCIT019
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="YCIT019" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          YCIT019
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      <label class="md-nav__link" for="__nav_3_1">
        Labs
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Labs" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Labs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_2_Docker_basics/" class="md-nav__link">
        Lab 2 Docker Basics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_3_Advanced_Docker/" class="md-nav__link">
        Lab 3 Advanced Docker
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_4_Docker_Images/" class="md-nav__link">
        Lab 4 Managing Docker Images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_5_Docker_Compose/" class="md-nav__link">
        Lab 5 Docker Compose
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_6_Deploy_Kubernetes_kubeadm/" class="md-nav__link">
        Lab 6 Deploy Kubernetes Cluster with Kubeadm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_7_Kubernetes_Concepts/" class="md-nav__link">
        Lab 7 Kubernetes Concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_8_Kubernetes_Features/" class="md-nav__link">
        Lab 8 Kubernetes Features
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_9_Kubernetes_Scaling/" class="md-nav__link">
        Lab 9 Kubernetes Autoscaling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_10_Networking/" class="md-nav__link">
        Lab 10 Kubernetes Networking
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_Lab_11_Storage/" class="md-nav__link">
        Lab 11 Kubernetes Storage
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        Assignments
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Assignments" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Assignments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass1/" class="md-nav__link">
        Assignment1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass1_sol/" class="md-nav__link">
        Assignment1 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass2/" class="md-nav__link">
        Assignment2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass2_solution/" class="md-nav__link">
        Assignment2 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass3/" class="md-nav__link">
        Assignment3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass3_solution/" class="md-nav__link">
        Assignment3 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass4/" class="md-nav__link">
        Assignment4
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass4_sol/" class="md-nav__link">
        Assignment4 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass5/" class="md-nav__link">
        Assignment5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass5_solution/" class="md-nav__link">
        Assignment5 - Solution
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass6/" class="md-nav__link">
        Assignment6
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ycit019_ass6_solution/" class="md-nav__link">
        Assignment6 - Solution
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#working-with-git-and-iac" class="md-nav__link">
    Working with Git and IaC
  </a>
  
    <nav class="md-nav" aria-label="Working with Git and IaC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-your-iac-code-to-your-repository" class="md-nav__link">
    Add your IaC code to your repository
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-build-gcp-foundation-layer" class="md-nav__link">
    1 Build GCP Foundation Layer
  </a>
  
    <nav class="md-nav" aria-label="1 Build GCP Foundation Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-installing-terraform" class="md-nav__link">
    1.1 Installing Terraform
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-configure-gcp-credentials-for-terraform" class="md-nav__link">
    1.2 Configure GCP credentials for Terraform
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-initializing-terraform" class="md-nav__link">
    1.3 Initializing Terraform
  </a>
  
    <nav class="md-nav" aria-label="1.3 Initializing Terraform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-declare-terraform-providers" class="md-nav__link">
    1.3.1 Declare Terraform Providers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-configure-the-terraform-provider" class="md-nav__link">
    1.3.2 Configure the Terraform Provider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-initialize-terraform" class="md-nav__link">
    1.3.3 Initialize Terraform
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-terraform-variables" class="md-nav__link">
    1.4 Terraform Variables
  </a>
  
    <nav class="md-nav" aria-label="1.4 Terraform Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#141-declare-input-variables" class="md-nav__link">
    1.4.1 Declare Input Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#142-using-variables" class="md-nav__link">
    1.4.2 Using Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#143-working-with-variables-files" class="md-nav__link">
    1.4.3 Working with Variables files.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#144-validate-configuration-and-code-syntax" class="md-nav__link">
    1.4.4 Validate configuration and code syntax
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-create-gcp-project-using-terraform" class="md-nav__link">
    1.5 Create GCP project using Terraform
  </a>
  
    <nav class="md-nav" aria-label="1.5 Create GCP project using Terraform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#151-configure-google_project-resource" class="md-nav__link">
    1.5.1 Configure google_project resource
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#152-making-project-resource-immutable" class="md-nav__link">
    1.5.2 Making Project resource Immutable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#153-create-a-project-using-terraform-random-provider" class="md-nav__link">
    1.5.3 Create a Project using Terraform Random Provider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#153-create-a-project_id-name-using-local-values" class="md-nav__link">
    1.5.3 Create a Project_ID name using Local Values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#154-configure-terraform-output-for-gcp-project" class="md-nav__link">
    1.5.4 Configure Terraform Output for GCP Project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#155-recreate-gcp-project-without-default-vpc" class="md-nav__link">
    1.5.5 Recreate GCP Project without Default VPC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-create-gcp-storage-bucket" class="md-nav__link">
    1.6 Create GCP Storage bucket
  </a>
  
    <nav class="md-nav" aria-label="1.6 Create GCP Storage bucket">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#161-create-gcp-storage-bucket-in-new-gcp-project" class="md-nav__link">
    1.6.1 Create GCP Storage bucket in New GCP Project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#162-configure-versioning-on-gcp-storage-bucket" class="md-nav__link">
    1.6.2 Configure versioning on GCP Storage bucket.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-build-gcp-services-layer" class="md-nav__link">
    2 Build GCP Services Layer
  </a>
  
    <nav class="md-nav" aria-label="2 Build GCP Services Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-initialize-terraform-for-gcp-services-layer" class="md-nav__link">
    2.1  Initialize Terraform for GCP Services Layer
  </a>
  
    <nav class="md-nav" aria-label="2.1  Initialize Terraform for GCP Services Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#211-define-and-configure-terraform-provider" class="md-nav__link">
    2.1.1 Define and configure terraform provider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#212-configure-terraform-state-backend" class="md-nav__link">
    2.1.2 Configure Terraform State backend
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-enable-required-gcp-services-api" class="md-nav__link">
    2.2 Enable required GCP Services API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-create-a-custom-mode-network-vpc-with-terraform" class="md-nav__link">
    2.3 Create a custom mode network (VPC) with terraform
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-create-a-create-a-user-managed-subnet" class="md-nav__link">
    2.4 Create a create a user-managed subnet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-create-a-nat-router" class="md-nav__link">
    2.5 Create a NAT router
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-create-a-cloud-nat" class="md-nav__link">
    2.6 Create a Cloud Nat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-create-a-private-gke-cluster-and-delete-default-node-pool" class="md-nav__link">
    2.7 Create a Private GKE Cluster and delete default node pool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-create-a-gke-custom-node_pool" class="md-nav__link">
    2.8 Create a GKE custom-node_pool
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-workaround-for-project-quota-issue" class="md-nav__link">
    3. Workaround for Project Quota issue
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-commit-readme-doc-to-repository-and-share-it-with-instructorteacher" class="md-nav__link">
    4 Commit Readme doc to repository and share it with Instructor/Teacher
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-cleanup" class="md-nav__link">
    5 Cleanup
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>020 Assignment 3 sol Terraform GCP Foundation</h1>
                
                <p>Lab 3 Creating Production GKE Cluster via IaC using Terraform</p>
<p><strong>Objective:</strong></p>
<ul>
<li>Learn Terraform Commands</li>
<li>Learn GCP Terraform Provider</li>
<li>Learn Terraform variables</li>
<li>Store TF State in GCS buckets</li>
<li>Learn how to create GCP resources with Terraform </li>
</ul>
<h2 id="working-with-git-and-iac">Working with Git and IaC<a class="headerlink" href="#working-with-git-and-iac" title="Permanent link">&para;</a></h2>
<p>Git-based workflows, merge requests and peer reviews create a level of documented transparency that is great for security teams
and audits. They ensure every change is documented as well as the metadata surrounding the change, answering the why, who,
when and what questions.</p>
<p>In this set of exercises you will continue using <code>notepad</code> Google Source Repository that already contains you application code,
<code>dockerfiles</code> and kubernetes manifests.</p>
<p>We will use so called <a href="https://en.wikipedia.org/wiki/Monorepo">Monorepo</a> and store our terraform IAC configuration using the same repo.</p>
<h3 id="add-your-iac-code-to-your-repository">Add your IaC code to your repository<a class="headerlink" href="#add-your-iac-code-to-your-repository" title="Permanent link">&para;</a></h3>
<p><strong>Step 1</strong> Go into your personal Google Cloud Source Repository:</p>
<div class="codehilite"><pre><span></span><code>MY_REPO=your_student_id-notepad
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Replace $student_id with your ID</p>
</div>
<div class="codehilite"><pre><span></span><code>cd ~/$MY_REPO
</code></pre></div>

<div class="codehilite"><pre><span></span><code>git pull                              # Pull latest code from you repo
</code></pre></div>

<p><strong>Step 2</strong> Create <code>foundation-infrastructure</code> and <code>notepad-infrastructure</code> folders that will contains respective terraform configurations</p>
<div class="codehilite"><pre><span></span><code>cd ~/$MY_REPO
mkdir foundation-infrastructure
mkdir notepad-infrastructure
</code></pre></div>

<p><strong>Step 3</strong> Create a <code>README.md</code> file describing <code>foundation-infrastructure</code> folder purpose:  </p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF&gt; foundation-infrastructure/README.md

# Creation of GCP Foundation Layer

This step, is focused on creating GCP Foundation: folders (if any) and service projects creation with their respictive GCS bucket to store terraform state and IAM Config.

EOF
</code></pre></div>

<p><strong>Step 4</strong> Create a <code>README.md</code> file describing <code>notepad-infrastructure</code> folder purpose:  </p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF&gt; notepad-infrastructure/README.md
# Creation of GCP Services Layer

This step, is focused on creating gcp services such as GKE, VPC and etc. inside of existing project

EOF
</code></pre></div>

<p><strong>Step 5</strong> Create a .gitignore file in your working directory:</p>
<div class="codehilite"><pre><span></span><code>cat&lt;&lt;EOF&gt;&gt; .gitignore
.terraform.*
.terraform
terraform.tfstate*
EOF
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ignore files are used to tell <code>git</code> not to track files. You should also always include any files with credentials in a</p>
</div>
<p><code>gitignore</code> file.</p>
<p>List created folder structure along with <code>gitignore</code>:</p>
<div class="codehilite"><pre><span></span><code>ls -ltra
</code></pre></div>

<p><strong>Step 6</strong> Commit <code>deploy</code> folder using the following Git commands:</p>
<div class="codehilite"><pre><span></span><code>git status 
git add .
git commit -m &quot;Terraform Folder structure for assignement 3&quot;
</code></pre></div>

<p><strong>Step 6</strong> Once you've committed code to the local repository, add its contents to Cloud Source Repositories using the git push command:</p>
<div class="codehilite"><pre><span></span><code>git push origin master
</code></pre></div>

<h2 id="1-build-gcp-foundation-layer">1 Build GCP Foundation Layer<a class="headerlink" href="#1-build-gcp-foundation-layer" title="Permanent link">&para;</a></h2>
<p>In this Lab we going to build GCP Foundation layer. As we learned in the class this includes Org Structure creation with Folders and Projects,
creation IAM Roles and assigning them to users and groups in organization. This Layer usually build be DevOps or Infra team that.</p>
<p>Since we don't have organization registered for each student, we going to skip creation of folders and IAM groups.
We going to start from creation of a Project, deleting <code>default</code> VPC and configuring inside that project a <code>gcs</code> bucket that will be 
used in the next terraform layer to store a Terraform state.</p>
<p><strong>Part 1:</strong> Create Terraform Configurations file to create's  GCP Foundation Layer:</p>
<p>Layer 1 From existing  (we going to call it seeding) project that you currently use to store code in Google Cloud Source Repository:</p>
<ul>
<li>Create structure: provider.tf, variable.tf, variables.tfvars, main.tf, output.tf</li>
<li>Create a new <code>notepad-dev</code> Project<ul>
<li>Delete Default VPC</li>
</ul>
</li>
<li>Create a bucket in this project to store terraform state</li>
</ul>
<p><strong>Part 2:</strong> Create Terraform Configurations file that create's  GCP Services Layer:</p>
<p>Layer 2 From <code>notepad-dev</code> GCP Project:</p>
<ul>
<li>Enable Google Project Service APIs</li>
<li>Create VPC (google_compute_network) and Subnet (google_compute_subnetwork)</li>
<li>Create Cloud Nat (google_compute_router) and (google_compute_router_nat)</li>
<li>Private GKE<ul>
<li>Private Nodes with Public API Endpoint (for simplicity)</li>
</ul>
</li>
</ul>
<h3 id="11-installing-terraform">1.1 Installing Terraform<a class="headerlink" href="#11-installing-terraform" title="Permanent link">&para;</a></h3>
<p>GCP Cloud Shell comes with many common tools pre-installed including <code>terraform</code></p>
<p>Verify and validate the version of Terraform that is installed:</p>
<div class="codehilite"><pre><span></span><code>terraform --version
</code></pre></div>

<p>If you want to use specific version of terraform or want to install terraform in you local machine use following <a href="https://www.terraform.io/downloads.html">link</a> to download binary.</p>
<h3 id="12-configure-gcp-credentials-for-terraform">1.2 Configure GCP credentials for Terraform<a class="headerlink" href="#12-configure-gcp-credentials-for-terraform" title="Permanent link">&para;</a></h3>
<p>If you would like to use terraform on GCP you have 2 options:</p>
<p>1). Using you user credentials, great option for testing terraform from you laptop and for learning purposes.</p>
<p>2). Using <a href="https://cloud.google.com/docs/authentication/getting-started#command-line">service account</a>, great option if you going to use terraform with CI/CD system and fully automate Terraform deployment.</p>
<p>In this Lab we going to use Option 1 - using user credentials.</p>
<p><strong>Step 1:</strong> In order to make requests against the GCP API, you need to authenticate to prove that it's you making the request. 
The preferred method of provisioning resources with Terraform on your workstation is to use the Google Cloud SDK (Option 1) </p>
<div class="codehilite"><pre><span></span><code>gcloud auth application-default login
</code></pre></div>

<h3 id="13-initializing-terraform">1.3 Initializing Terraform<a class="headerlink" href="#13-initializing-terraform" title="Permanent link">&para;</a></h3>
<p>Terraform relies on <code>providers</code> to interact with remote systems. Every resource type is implemented by a provider; without
<code>providers</code>, Terraform can't manage any kind of infrastructure; in order for terraform to install and use a provider it must be
declared.</p>
<p>In this exercise you will declare and configure the Terraform provider(s) that will be used for the rest of the Lab.</p>
<h4 id="131-declare-terraform-providers">1.3.1 Declare Terraform Providers<a class="headerlink" href="#131-declare-terraform-providers" title="Permanent link">&para;</a></h4>
<p>The <code>required_providers</code> block defines the providers terraform will use to provision resources and their source.</p>
<ul>
<li>
<p><code>version</code>: The version argument is optional and is used to tell terraform to pick a particular version from the available
versions</p>
</li>
<li>
<p><code>source</code>: The source is the provider registry e.g. hashicorp/gcp is the short for registry.terraform.io/hashicorp/gcp</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code>cd ~/$MY_REPO/foundation-infrastructure/
cat &lt;&lt; EOF&gt;&gt; provider.tf
terraform {
  required_providers {
    google = {
      source  = &quot;hashicorp/google&quot;
      version = &quot;~&gt; 3.70.0&quot;
    }
  }
}
EOF
</code></pre></div>

<h4 id="132-configure-the-terraform-provider">1.3.2 Configure the Terraform Provider<a class="headerlink" href="#132-configure-the-terraform-provider" title="Permanent link">&para;</a></h4>
<p>Providers often require configuration (like endpoint URLs or cloud regions) before they can be used. These configurations are defined by a <code>provider</code> block. Multiple provider configuration blocks can be declared for the same by adding the <code>alias</code>
argument</p>
<p>Set you current <code>PROJECT_ID</code> value here:</p>
<div class="codehilite"><pre><span></span><code>export PROJECT_ID=&lt;YOUR_PROJECT_ID&gt;
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cd ~/$MY_REPO/foundation-infrastructure/
cat &lt;&lt; EOF&gt;&gt; main.tf
provider &quot;google&quot; {
  alias   = &quot;gcp-provider&quot;
  project = &quot;$PROJECT_ID&quot;
  region  = &quot;us-central1&quot;
}
EOF
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>We configured <code>provider</code>, so that it can provision resource in specified gcp project in <code>us-central1</code> region.</p>
</div>
<h4 id="133-initialize-terraform">1.3.3 Initialize Terraform<a class="headerlink" href="#133-initialize-terraform" title="Permanent link">&para;</a></h4>
<p>Now that you have declared and configured the GCP provider for terraform, initialize terraform:</p>
<div class="codehilite"><pre><span></span><code>cd ~/$MY_REPO/foundation-infrastructure/
terraform init
</code></pre></div>

<p>Explore your directory. What has changed?</p>
<div class="codehilite"><pre><span></span><code>ls -ltra
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>We can see that new directory <code>.terraform</code> and <code>.terraform.lock.hcl</code> file.</p>
</div>
<p><strong>Extra!</strong></p>
<p>Investigate available providers in the <a href="https://registry.terraform.io/">Terraform Provider Registry</a></p>
<p>Select another provider from the list, add it to your required providers, and to your main.tf</p>
<p>Run terraform init to load your new provider!</p>
<h3 id="14-terraform-variables">1.4 Terraform Variables<a class="headerlink" href="#14-terraform-variables" title="Permanent link">&para;</a></h3>
<p>Input variables are used to increase your Terraform configuration's flexibility by defining values that can be assigned to customize the configuration. They provide a consistent interface to change how a given configuration behaves. Input variables blocks have a defined format:</p>
<p>Input variables blocks have a defined format:</p>
<div class="codehilite"><pre><span></span><code>variable &quot;variable_name&quot; {
  type = &quot;The variable type eg. string , list , number&quot;
  description = &quot;A description to understand what the variable will be used for&quot;
  default = &quot;A default value can be provided, terraform will use this if no other value is provided at terraform apply&quot;
}
</code></pre></div>

<p>Terraform CLI defines the following optional arguments for variable declarations:</p>
<ul>
<li>default - A default value which then makes the variable optional.</li>
<li>type - This argument specifies what value types are accepted for the variable.</li>
<li>description - This specifies the input variable's documentation.</li>
<li>validation - A block to define validation rules, usually in addition to type constraints.</li>
<li>sensitive - Limits Terraform UI output when the variable is used in configuration.</li>
</ul>
<p>In our above example for <code>main.tf</code> we can actually declare <code>project</code> and <code>region</code> as variables, so let's do it.</p>
<h4 id="141-declare-input-variables">1.4.1 Declare Input Variables<a class="headerlink" href="#141-declare-input-variables" title="Permanent link">&para;</a></h4>
<p>Variables are declared in a <code>variables.tf</code> file inside your terraform working directory.</p>
<p>The label after the variable keyword is a name for the variable, which must be unique among all variables in the same module.  You can choose variable name based on you preference, or in some cases based on agreed in company naming convention. In our case we declaring variables names: <code>gcp_region</code> and <code>gcp_project_id</code></p>
<p>We are going to declare a type as a  <code>string</code> variable for <code>gcp_project_id</code> and <code>gcp_region</code>.</p>
<p>It is always good idea to specify a clear <code>description</code> for the variable for documentation purpose as well as code reusability and readability.</p>
<p>Finally, let's configured <code>default</code> argument. In our case we going to use "us-central1" as a <code>default</code> for <code>gcp_region</code> and we going to keep <code>default</code> value empty for <code>gcp_project_id</code>.</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF&gt; variables.tf
variable &quot;gcp_region&quot; {
  type        = string
  description = &quot;The GCP Region&quot;
  default     = &quot;us-central1&quot;
}

variable &quot;gcp_project_id&quot; {
  type        = string
  description = &quot;The GCP Seeding project ID&quot;
  default     = &quot;&quot;
}
EOF
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Explore other <a href="https://www.terraform.io/docs/language/values/variables.html#type-constraints">type</a> of variables such as <code>number</code>, <code>bool</code> and type constructors such as: list(<TYPE>), set(<TYPE>), map(<TYPE>)</p>
</div>
<h4 id="142-using-variables">1.4.2 Using Variables<a class="headerlink" href="#142-using-variables" title="Permanent link">&para;</a></h4>
<p>Now that you have created your input variables, let's re-create <code>main.tf</code> that currently has the terraform configuration for GCP Provider.</p>
<div class="codehilite"><pre><span></span><code>rm main.tf
cat &lt;&lt; EOF&gt;&gt; main.tf
provider &quot;google&quot; {
  alias   = &quot;gcp-provider&quot;
  project = var.gcp_project_id
  region  = var.gcp_region
}
EOF
</code></pre></div>

<p>Test out your terraform configuration:</p>
<div class="codehilite"><pre><span></span><code>terraform plan
</code></pre></div>

<h4 id="143-working-with-variables-files">1.4.3 Working with Variables files.<a class="headerlink" href="#143-working-with-variables-files" title="Permanent link">&para;</a></h4>
<p>Create a <code>terraform.tfvars</code> file to hold the values for your variables:</p>
<div class="codehilite"><pre><span></span><code>export gcp_project_id=&lt;YOUR_PROJECT_ID&gt;
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; terraform.tfvars
gcp_project_id = &quot;$PROJECT_ID&quot;
gcp_region = &quot;us-central1&quot;
EOF
</code></pre></div>

<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>using different <code>env-name.tfvars</code> files you can create different set of terraform configuration for the same code. (e.g. code for dev, staging, prod)</p>
</div>
<h4 id="144-validate-configuration-and-code-syntax">1.4.4 Validate configuration and code syntax<a class="headerlink" href="#144-validate-configuration-and-code-syntax" title="Permanent link">&para;</a></h4>
<p>Let's Validate configuration and code syntax that we've added so far.</p>
<p>There are several tools that can analyze your Terraform code without running it, including:</p>
<p>Terraform has build in command that you can use to check your Terraform syntax and types (a bit like a compiler):</p>
<div class="codehilite"><pre><span></span><code>terraform validate
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Seems the code is legit so far</p>
</div>
<p>Is your terraform easy to read and follow? Terraform has a built-in function to lint your configuration manifests
for readability and best practice spacing:</p>
<div class="codehilite"><pre><span></span><code>terraform fmt --recursive
</code></pre></div>

<p>The <code>--recursive</code> flag asks the <code>fmt</code> command to traverse all of your terraform directories and format the .tf files it finds. It
will report the files it changed as part of the return information of the command</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Use the git diff command to see what was changed.</p>
</div>
<div class="admonition result">
<p class="admonition-title">Result</p>
<p>We can see that <code>terraform.tfvars</code> file had some spacing that been fixed for better code readability.</p>
</div>
<div class="admonition extra">
<p class="admonition-title">Extra</p>
<p>Another cool tool that you can use along you terraform development is <a href="https://github.com/terraform-linters/tflint/blob/master/README.md">tflint</a> - framework and each feature is provided by plugins, the key features are as follows:</p>
<ul>
<li>Find possible errors (like illegal instance types) for Major Cloud providers (AWS/Azure/GCP).</li>
<li>Warn about deprecated syntax, unused declarations.</li>
<li>Enforce best practices, naming conventions.</li>
</ul>
</div>
<p>Finally let's run <code>terraform plan</code>:</p>
<div class="codehilite"><pre><span></span><code>terraform plan
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>No changes. Your infrastructure matches the configuration.
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>We don't have any errors, however we don't have any resources created so far. Let's create a GCP project resource to start with!</p>
</div>
<h3 id="15-create-gcp-project-using-terraform">1.5 Create GCP project using Terraform<a class="headerlink" href="#15-create-gcp-project-using-terraform" title="Permanent link">&para;</a></h3>
<h4 id="151-configure-google_project-resource">1.5.1 Configure <code>google_project</code> resource<a class="headerlink" href="#151-configure-google_project-resource" title="Permanent link">&para;</a></h4>
<p><code>Resources</code> describe the infrastructure objects you want terraform to create. A resource block can be used to create any object such as virtual private cloud,
security groups, DNS records etc.</p>
<p>Let's create our first Terraform resource: GCP project.</p>
<p>In order to accomplish this we going to use <code>google_project</code> resource, documented <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project">here</a></p>
<p>In order to create a new Project we need to define following arguments:
  * name - (Required) The display name of the project.
  * project_id - (Required) The project ID. Changing this forces a new project to be created.
  * billing_account - The alphanumeric ID of the billing account this project belongs to.</p>
<p>First, Let's declare actual values for <code>name</code>, <code>project_id</code> and <code>billing_account</code> with variables:</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; variables.tf
variable &quot;billing_account&quot; {
  description = &quot;The billing account ID for this project&quot;
}

variable &quot;project_name&quot; {
  description = &quot;The human readable project name (min 4 letters)&quot;
}

variable &quot;project_id&quot; {
  description = &quot;The GCP project ID&quot;
}
EOF
</code></pre></div>

<p>Then, update <code>terraform.tfvars</code> variables files, with actual values for  <code>name</code>, <code>project_id</code> and <code>billing_account</code>:</p>
<p>We going to use same naming structure for <code>PROJECT_ID</code> and <code>PROJECT_NAME</code> as in previous Assignment, in order to define your new GCP project:</p>
<div class="codehilite"><pre><span></span><code>export ORG=&lt;student-name&gt;
</code></pre></div>

<div class="codehilite"><pre><span></span><code>export ORG=ayrat
export PRODUCT=notepad
export ENV=dev
export PROJECT_PREFIX=4  
export PROJECT_NAME=$ORG-$PRODUCT-$ENV
export PROJECT_ID=$ORG-$PRODUCT-$ENV-$PROJECT_PREFIX  # Project ID has to be unique
echo $PROJECT_NAME
echo $PROJECT_ID
</code></pre></div>

<p>In order to get Billing account run following command:</p>
<div class="codehilite"><pre><span></span><code>ACCOUNT_ID=$(gcloud alpha billing accounts list | grep Education | grep True |awk &#39;{ print $1 }&#39;)
echo $ACCOUNT_ID
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; terraform.tfvars
billing_account = &quot;$ACCOUNT_ID&quot;
project_name    = &quot;$PROJECT_NAME&quot;
project_id      = &quot;$PROJECT_ID&quot;
EOF
</code></pre></div>

<p>Verify if everything looks good, and correct values has been set:</p>
<div class="codehilite"><pre><span></span><code>cat terraform.tfvars
</code></pre></div>

<p>Finally, let's define <code>google_project</code> resource in <code>project.tf</code> file, we will replace actual values for <code>name</code> and <code>billing_account</code> with variables:</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; project.tf
resource &quot;google_project&quot; &quot;project&quot; {
  name                = var.project_name
  billing_account     = var.billing_account
  project_id          = var.project_id
}
EOF
</code></pre></div>

<p>Run plan command:</p>
<div class="codehilite"><pre><span></span><code>terraform plan -var-file terraform.tfvars
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p><code>Plan: 1 to add, 0 to change, 0 to destroy.</code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Take notice of plan command and see how some values that you declared in <code>*.tvfars</code> are visible and some values will <code>known after apply</code></p>
</div>
<div class="codehilite"><pre><span></span><code>terraform apply -var-file terraform.tfvars
</code></pre></div>

<div class="admonition success">
<p class="admonition-title">Success</p>
<p>We've created our first resource with terrraform</p>
</div>
<h4 id="152-making-project-resource-immutable">1.5.2 Making Project resource Immutable<a class="headerlink" href="#152-making-project-resource-immutable" title="Permanent link">&para;</a></h4>
<p>Very often when you developing IaC, you need to destroy and recreate your resorces, e.g. for troubleshooting or creating a new resources using same config.
Let's <code>destroy</code> our project and try to recreate it again.</p>
<div class="codehilite"><pre><span></span><code>terraform destroy -var-file terraform.tfvars
</code></pre></div>

<div class="codehilite"><pre><span></span><code>terraform apply -var-file terraform.tfvars
</code></pre></div>

<div class="admonition failed">
<p class="admonition-title">Failed</p>
<p>What happened? Did you project been able to create? If not why ?</p>
</div>
<p>If we want to make our infrastructure to be Immutable and fully automated, we need to make sure that we can destroy our service and recreate it any time the same way.
In our case we can't do that because  <code>Project ID</code> always has to be unique.
To tackle this problem we need to randomize our <code>Project ID</code>  creation within the terraform.</p>
<h4 id="153-create-a-project-using-terraform-random-provider">1.5.3 Create a Project using Terraform Random Provider<a class="headerlink" href="#153-create-a-project-using-terraform-random-provider" title="Permanent link">&para;</a></h4>
<p>In order to create a GCP Project with Random name, we can use Terraform's <a href="https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/integer">random_integer resource</a> with following arguments:</p>
<ul>
<li>max (Number) The maximum inclusive value of the range - 100</li>
<li>min (Number) The minimum inclusive value of the range - 999</li>
</ul>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; random.tf
resource &quot;random_integer&quot; &quot;id&quot; {
  min = 100
  max = 999
}
EOF
</code></pre></div>

<p><code>random_integer</code> resource doesn't belongs to Google Provider, it requires <a href="https://registry.terraform.io/providers/hashicorp/random/latest">Hashicorp Random Provider</a> to be initialized. Since it's native hashicorp provider we can skip the step of defining and configuring that provider, as it will be automatically initialized. </p>
<div class="codehilite"><pre><span></span><code>terraform init
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<ul>
<li>Installing hashicorp/random v3.1.0...</li>
<li>Installed hashicorp/random v3.1.0 (signed by HashiCorp)</li>
</ul>
</div>
<h4 id="153-create-a-project_id-name-using-local-values">1.5.3 Create a Project_ID name using Local Values<a class="headerlink" href="#153-create-a-project_id-name-using-local-values" title="Permanent link">&para;</a></h4>
<p><code>Local</code> Values allow you to assign a name to an expression, so the expression can be used multiple times, without repeating it.</p>
<p>We going to define value of <code>project_id</code> as local. And it will be a combination of <code>project_name</code> <code>-</code> <code>random_number</code>.</p>
<p>Let's add local value for <code>project_id</code> and replace value <code>var.project_id</code> with <code>local.project_id</code>.</p>
<div class="codehilite"><pre><span></span><code>edit project.tf
</code></pre></div>

<p>Update code snippet of <code>project.tf</code> as following and save:</p>
<div class="codehilite"><pre><span></span><code>locals {
  project_id     = &quot;${var.project_name}-${random_integer.id.result}&quot;
}

resource &quot;google_project&quot; &quot;project&quot; {
  name                = var.project_name
  billing_account     = var.billing_account
  project_id          = local.project_id
}
</code></pre></div>

<p>We can now remove <code>project_id</code> value from <code>terraform.tfvars</code>, as we going to randomly generate it using <code>locals</code> expression with <code>random_integer</code></p>
<div class="codehilite"><pre><span></span><code>edit terraform.tfvars
</code></pre></div>

<p>Remove <code>project_id</code> line and save.</p>
<p>We can now also remove <code>project_id</code> variable from <code>variables.tf</code>:</p>
<div class="codehilite"><pre><span></span><code>rm variables.tf
cat &lt;&lt;EOF &gt;&gt; variables.tf
variable &quot;gcp_region&quot; {
  type        = string
  description = &quot;The GCP Region&quot;
  default     = &quot;us-central1&quot;
}

variable &quot;gcp_project_id&quot; {
  type        = string
  description = &quot;The GCP Seeding project ID&quot;
  default     = &quot;&quot;
}
variable &quot;billing_account&quot; {
  description = &quot;The billing account ID for this project&quot;
}

variable &quot;project_name&quot; {
  description = &quot;The human readable project name (min 4 letters)&quot;
}
EOF
</code></pre></div>

<div class="codehilite"><pre><span></span><code>terraform plan -var-file terraform.tfvars
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>  # random_integer.id will be created
  + resource &quot;random_integer&quot; &quot;id&quot; {
      + id     = (known after apply)
      + max    = 999
      + min    = 100
      + result = (known after apply)
    }
</code></pre></div>

<div class="codehilite"><pre><span></span><code>terraform apply -var-file terraform.tfvars
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Project has been created with Random project_id</p>
</div>
<h4 id="154-configure-terraform-output-for-gcp-project">1.5.4 Configure Terraform Output for GCP Project<a class="headerlink" href="#154-configure-terraform-output-for-gcp-project" title="Permanent link">&para;</a></h4>
<p><code>Outputs</code> provide return values of a Terraform state at any given time. So you can get for example values of what GCP resources like project, VMs, GKE cluster been created and their parametres.</p>
<p><code>Outputs</code> can be used used to export structured data about resources. This data can be used to configure other parts of your infrastructure, or as a data source for another Terraform workspace. Outputs are also necessary to share data from a child module to your root module.</p>
<p>Outputs follow a similar structure to variables:</p>
<div class="codehilite"><pre><span></span><code>output &quot;output_name&quot; {
  description = &quot;A description to understand what information is provided by the output&quot;
  value = &quot;An expression and/or resource_name.attribute&quot;
  sensitive = &quot;Optional argument, marking an output sensitive will supress the value from plan/apply phases&quot;
}
</code></pre></div>

<p>Let's declare GCP Project <code>output</code> values for <code>project_id</code> and <code>project_number</code>.</p>
<p>You can find available <code>output</code> in each respective <code>resource</code> documents, under `<a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project#attributes-reference">Attributes Reference</a>.</p>
<p>For example for GCP project available outputs are:</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; outputs.tf
output &quot;id&quot; {
  value = google_project.project.project_id
  description = &quot;GCP project ID&quot;
}

output &quot;number&quot; {
  value = google_project.project.number
  description = &quot;GCP project number&quot;
  sensitive = true
}
EOF
</code></pre></div>

<div class="codehilite"><pre><span></span><code>terraform plan -var-file terraform.tfvars
</code></pre></div>

<p>We can see that we have new changes to output:</p>
<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>Changes to Outputs:
  + id     = &quot;ayrat-notepad-dev-631&quot;
  + number = (sensitive value)
</code></pre></div>

<p>Let's apply this changes:</p>
<div class="codehilite"><pre><span></span><code>terraform apply -var-file terraform.tfvars
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>Apply complete! Resources: 0 added, 0 changed, 0 destroyed.
</code></pre></div>

<p>Let's now run <code>terraform output</code> command:</p>
<div class="codehilite"><pre><span></span><code>terraform output
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>We can see value of project <code>id</code>, however we don't see project number as it's been marked as sensitive.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>Outputs</code> can be useful when you want to provide results of terraform resource creation to CI/CD or next automation tool like <code>helm</code> to deploy application.</p>
</div>
<h4 id="155-recreate-gcp-project-without-default-vpc">1.5.5 Recreate GCP Project without Default VPC<a class="headerlink" href="#155-recreate-gcp-project-without-default-vpc" title="Permanent link">&para;</a></h4>
<p>One of the requirements for our solution is to create GCP project with <code>custom</code> VPC. However, when terraform creates GCP Project it creates <code>DEFAULT</code> vpc by default.</p>
<div class="codehilite"><pre><span></span><code>gcloud compute networks list --project ayrat-notepad-dev-631
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>NAME     SUBNET_MODE  BGP_ROUTING_MODE  IPV4_RANGE  GATEWAY_IPV4
default  AUTO         REGIONAL
</code></pre></div>

<p>In order to remove automatically created <code>default</code> VPC, specify special attribute during <code>google_project</code> resource creation. Check documentation <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project">here</a> and find this argument.</p>
<p><strong>Task N1:</strong> Find Attribute to remove <code>default</code> VPC during  <code>google_project</code> resource creation. Define in it <code>project.tf</code> and set it's value in <code>variables.tf</code> as <code>true</code> by default.</p>
<div class="codehilite"><pre><span></span><code>edit project.tf
</code></pre></div>

<p>Update code snippet of <code>project.tf</code> as following and save:</p>
<div class="codehilite"><pre><span></span><code>locals {
  project_id     = &quot;${var.project_name}-${random_integer.id.result}&quot;
}

resource &quot;google_project&quot; &quot;project&quot; {
  name                = var.project_name
  billing_account     = var.billing_account
  project_id          = local.project_id
  auto_create_network = var.auto_create_network
}
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; variables.tf
variable &quot;auto_create_network&quot; {
  description = &quot;Automatically provision a default global VPC network&quot;
  default     = false
}
EOF
</code></pre></div>

<p>After changes you need to re-create a project, as vpc get's deleted during project creation only.</p>
<div class="codehilite"><pre><span></span><code>terraform destroy -var-file terraform.tfvars
</code></pre></div>

<div class="codehilite"><pre><span></span><code>terraform plan -var-file terraform.tfvars
terraform apply -var-file terraform.tfvars
</code></pre></div>

<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>How long project is now getting created. This is due to after project creation, <code>default</code> vpc is being removed.</p>
</div>
<p>Verify that <code>default</code> VPC has been deleted:</p>
<div class="codehilite"><pre><span></span><code>gcloud compute networks list --project ayrat-notepad-dev-631
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>Listed 0 items.
</code></pre></div>

<div class="admonition success">
<p class="admonition-title">Success</p>
<p>We now able to create a GCP project without <code>Default</code> VPC.</p>
</div>
<h3 id="16-create-gcp-storage-bucket">1.6 Create GCP Storage bucket<a class="headerlink" href="#16-create-gcp-storage-bucket" title="Permanent link">&para;</a></h3>
<h4 id="161-create-gcp-storage-bucket-in-new-gcp-project">1.6.1 Create GCP Storage bucket in New GCP Project<a class="headerlink" href="#161-create-gcp-storage-bucket-in-new-gcp-project" title="Permanent link">&para;</a></h4>
<p>Using reference doc for <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket">google_storage_bucket
</a>, let's create <code>google_storage_bucket</code> resource that will create MULTI_REGIONAL GCS bucket in newly created project. We going to give bucket <code>name</code>: <code>$ORG-notepad-dev-tfstate</code>, and we going to use this bucket to store Terraform state for GCP Service Layer.</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt;  bucket.tf
resource &quot;google_storage_bucket&quot; &quot;state&quot; {
  name          = var.bucket_name
  project       = local.project_id
  storage_class = var.storage_class

  force_destroy = &quot;true&quot;
}
EOF
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; variables.tf
variable &quot;bucket_name&quot; {
  description = &quot;The name of the bucket.&quot;
}

variable &quot;storage_class&quot; {
  description = 
  default = &quot;MULTI_REGIONAL&quot;
}
EOF
</code></pre></div>

<p>Set variable that will be used to build name for a bucket:</p>
<div class="codehilite"><pre><span></span><code>export ORG=&lt;student-name&gt;
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; terraform.tfvars
bucket_name   = &quot;$ORG-notepad-dev-tfstate&quot;
EOF
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; outputs.tf
output &quot;bucket_name&quot; {
  value = google_storage_bucket.state.name
}
EOF
</code></pre></div>

<p>Let's review the plan:</p>
<div class="codehilite"><pre><span></span><code>terraform plan -var-file terraform.tfvars
</code></pre></div>

<p>And create google_storage_bucket resource:</p>
<div class="codehilite"><pre><span></span><code>terraform apply -var-file terraform.tfvars
</code></pre></div>

<p>Verify created bucket in GCP UI:</p>
<div class="codehilite"><pre><span></span><code>Storage -&gt; Cloud Storage
</code></pre></div>

<div class="codehilite"><pre><span></span><code>gsutil ls -L -b gs://$ORG-notepad-dev-tfstate
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>GCS bucket for terraform state has been created</p>
</div>
<h4 id="162-configure-versioning-on-gcp-storage-bucket">1.6.2 Configure <code>versioning</code> on GCP Storage bucket.<a class="headerlink" href="#162-configure-versioning-on-gcp-storage-bucket" title="Permanent link">&para;</a></h4>
<p>Check if versioning enabled on the created bucket:</p>
<div class="codehilite"><pre><span></span><code>gsutil versioning get gs://$ORG-notepad-dev-tfstate
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Versioning: Suspended</p>
</div>
<p>It is highly recommended that if you going to use GCS bucket as <a href="https://www.terraform.io/docs/language/settings/backends/gcs.html">Terraform storage backend</a> you should enable Object Versioning on the GCS bucket to allow for state recovery in the case of accidental deletions and human error.</p>
<p><strong>Task N2:</strong> Using reference doc for <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket">google_storage_bucket
</a> find and configure argument that enables gcs bucket versioning feature.</p>
<p>Edit <code>bucket.tf</code> with correct argument.</p>
<div class="codehilite"><pre><span></span><code>edit bucket.tf
</code></pre></div>

<p><strong>Solution:</strong></p>
<div class="codehilite"><pre><span></span><code>resource &quot;google_storage_bucket&quot; &quot;state&quot; {
  name          = var.bucket_name
  project       = local.project_id
  storage_class = var.storage_class

  versioning {
    enabled = false
  }

  force_destroy = &quot;true&quot;
}
</code></pre></div>

<div class="codehilite"><pre><span></span><code>terraform plan -var-file terraform.tfvars
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>Plan: 0 to add, 1 to change, 0 to destroy.
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Configuration for Versioning looks correct</p>
</div>
<div class="codehilite"><pre><span></span><code>terraform apply -var-file terraform.tfvars
</code></pre></div>

<p>Verify versioning is ON:</p>
<div class="codehilite"><pre><span></span><code>gsutil versioning get gs://$ORG-notepad-dev-tfstate
</code></pre></div>

<p><strong>Output:</strong></p>
<div class="codehilite"><pre><span></span><code>Versioning Enabled
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>We've finished building the Foundation Layer. So far we able to accomplish following:</p>
<ul>
<li>Create structure: provider.tf, variable.tf, variables.tfvars, main.tf, output.tf</li>
<li>Create a new <code>notepad-dev</code> Project</li>
<li>Delete Default VPC</li>
<li>Create a bucket in this project to store terraform state</li>
</ul>
</div>
<h2 id="2-build-gcp-services-layer">2 Build GCP Services Layer<a class="headerlink" href="#2-build-gcp-services-layer" title="Permanent link">&para;</a></h2>
<p>Once we finished building a GCP Foundation layer which is essentially our project, we can start building  GCP Services Layer inside that project.</p>
<p>This second layer will configure following items:</p>
<ul>
<li>Enable Google Project Service APIs</li>
<li>Create VPC (google_compute_network) and Subnet (google_compute_subnetwork)</li>
<li>Create Cloud Nat (google_compute_router) and (google_compute_router_nat)</li>
<li>Private GKE<ul>
<li>Private Nodes with Public API Endpoint (for simplicity)</li>
</ul>
</li>
</ul>
<h3 id="21-initialize-terraform-for-gcp-services-layer">2.1  Initialize Terraform for GCP Services Layer<a class="headerlink" href="#21-initialize-terraform-for-gcp-services-layer" title="Permanent link">&para;</a></h3>
<h4 id="211-define-and-configure-terraform-provider">2.1.1 Define and configure terraform provider<a class="headerlink" href="#211-define-and-configure-terraform-provider" title="Permanent link">&para;</a></h4>
<p><strong>Step 1:</strong> Take note of newly created GCP Project_ID and BUCKET_ID:</p>
<p>cd ~/$MY_REPO/foundation-infrastructure</p>
<div class="codehilite"><pre><span></span><code>terraform output | grep &#39;id&#39; |awk &#39;{ print $3}&#39;
terraform output | grep &#39;bucket_name&#39; |awk &#39;{ print $3}&#39;
</code></pre></div>

<p>Set it as variable:</p>
<div class="codehilite"><pre><span></span><code>export PROJECT_ID=$(terraform output | grep &#39;id&#39; |awk &#39;{ print $3}&#39;)
export BUCKET_ID=$(terraform output | grep &#39;bucket_name&#39; |awk &#39;{ print $3}&#39;)
echo $PROJECT_ID
echo $BUCKET_ID
</code></pre></div>

<p><strong>Step 2:</strong> Declare the Terraform Provider for GCP Services Layer:</p>
<p>We now going to switch to <code>notepad-infrastructure</code> where we going to create a new GCP service Layer terraform configuration:</p>
<div class="codehilite"><pre><span></span><code>cd ~/$MY_REPO/notepad-infrastructure
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cat &lt;&lt; EOF&gt;&gt; provider.tf
terraform {
  required_providers { 
    google = {
      source  = &quot;hashicorp/google&quot;
      version = &quot;~&gt; 3.70.0&quot;
    }
  }
}
EOF
</code></pre></div>

<p><strong>Step 4:</strong> Configure the Terraform Provider</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt; EOF&gt;&gt; main.tf
provider &quot;google&quot; {
  project = var.gcp_project_id
  region  = var.gcp_region
}
EOF
</code></pre></div>

<p><strong>Step 5:</strong> Define variables:</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF&gt; variables.tf
variable &quot;gcp_region&quot; {
  type        = string
  description = &quot;The GCP Region&quot;
  default     = &quot;us-central1&quot;
}

variable &quot;gcp_project_id&quot; {
  type        = string
  description = &quot;The newly created GCP project ID&quot;
}
EOF
</code></pre></div>

<p><strong>Step 5:</strong> Set variables in <code>terraform.tfvars</code></p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; terraform.tfvars
gcp_project_id = $PROJECT_ID
EOF
</code></pre></div>

<p><strong>Step 4:</strong> Now that you have declared and configured the GCP provider for terraform, initialize terraform:</p>
<div class="codehilite"><pre><span></span><code>terraform init
</code></pre></div>

<h4 id="212-configure-terraform-state-backend">2.1.2 Configure Terraform State backend<a class="headerlink" href="#212-configure-terraform-state-backend" title="Permanent link">&para;</a></h4>
<p>Terraform records information about what infrastructure it created in a Terraform state file. This information, or state, is stored by
default in a <code>local</code> file named terraform.tfstate. This allows Terraform to compare what's in your configurations with what's in
the state file, and determine what changes need to be applied.</p>
<p><strong>Local vs Remote backend:</strong>
<code>Local</code> state files are the default for terraform. <code>Remote</code> state allows for collaboration between members of your team, as well as
more secure storage of sensitive values that might be contained in variables or outputs.</p>
<p>See documents for<a href="https://www.terraform.io/docs/language/settings/backends/remote.html">remote</a> backend for reference:</p>
<p><strong>Step 1</strong> Configure remote backend using gcs bucket:</p>
<p>Let's configure a backend for your state, using the <code>gcs</code> bucket you previously created in Foundation Layer.</p>
<p>Backends are configured with a nested backend block within the top-level terraform block While a backend can be declared
anywhere, it is recommended to use a <code>backend.tf</code>.</p>
<p>Since we running on GCP we going to use <a href="https://www.terraform.io/docs/language/settings/backends/gcs.html">GCS remote backend</a>.
It stores the state as an object in a configurable prefix in a pre-existing bucket on Google Cloud Storage (GCS). This backend also supports state locking. The bucket must exist prior to configuring the backend.</p>
<p>We going to use following arguments:</p>
<ul>
<li>bucket - (Required) The name of the GCS bucket. This name must be globally unique. For more information, see Bucket Naming Guidelines.</li>
<li>prefix - (Optional) GCS prefix inside the bucket. Named states for workspaces are stored in an object called <prefix>/<name>.tfstate.</li>
</ul>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; backend.tf
terraform {
  backend &quot;gcs&quot; {
    bucket = $BUCKET_ID
    prefix = &quot;state&quot;
  }
}
EOF
</code></pre></div>

<p><strong>Step 2</strong> 
When you change, configure or unconfigure a backend, terraform must be re-initialized:</p>
<div class="codehilite"><pre><span></span><code>terraform init
</code></pre></div>

<p>Verify if <code>folder</code> state has been created in our bucket:</p>
<div class="codehilite"><pre><span></span><code>gsutil ls gs://$ORG-notepad-dev-tfstate
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p><code>state</code> Folder has been created in gcs bucket and terrafrom has been initialized with  remote backend</p>
</div>
<h3 id="22-enable-required-gcp-services-api">2.2 Enable required GCP Services API<a class="headerlink" href="#22-enable-required-gcp-services-api" title="Permanent link">&para;</a></h3>
<p>Before we continue with creating GCP services like VPC, routers, Cloud Nat and GKE it is required to enable underlining GCP API services.
When we creating a new project most of the services API's are disabled, and requires explicitly to be enabled.
<code>google_project_service</code> <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_service">resource</a> allows management of a single API service for an existing Google Cloud Platform project.</p>
<p>Let's enable <code>compute engine API</code> service with terraform:</p>
<div class="codehilite"><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; services.tf
resource &quot;google_project_service&quot; &quot;compute&quot; {
  service = &quot;compute.googleapis.com&quot;
}
EOF
</code></pre></div>

<div class="codehilite"><pre><span></span><code>terraform plan -var-file terraform.tfvars
terraform apply -var-file terraform.tfvars
</code></pre></div>

<p>Verify Compute Engine API service has been enabled:</p>
<div class="codehilite"><pre><span></span><code>gcloud services list
</code></pre></div>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Compute Engine API is enabled as it is listed.</p>
</div>
<h3 id="23-create-a-custom-mode-network-vpc-with-terraform">2.3 Create a custom mode network (VPC) with terraform<a class="headerlink" href="#23-create-a-custom-mode-network-vpc-with-terraform" title="Permanent link">&para;</a></h3>
<h3 id="24-create-a-create-a-user-managed-subnet">2.4 Create a create a user-managed subnet<a class="headerlink" href="#24-create-a-create-a-user-managed-subnet" title="Permanent link">&para;</a></h3>
<h3 id="25-create-a-nat-router">2.5 Create a NAT router<a class="headerlink" href="#25-create-a-nat-router" title="Permanent link">&para;</a></h3>
<h3 id="26-create-a-cloud-nat">2.6 Create a Cloud Nat<a class="headerlink" href="#26-create-a-cloud-nat" title="Permanent link">&para;</a></h3>
<h3 id="27-create-a-private-gke-cluster-and-delete-default-node-pool">2.7 Create a Private GKE Cluster and delete default node pool<a class="headerlink" href="#27-create-a-private-gke-cluster-and-delete-default-node-pool" title="Permanent link">&para;</a></h3>
<h3 id="28-create-a-gke-custom-node_pool">2.8 Create a GKE custom-node_pool<a class="headerlink" href="#28-create-a-gke-custom-node_pool" title="Permanent link">&para;</a></h3>
<h2 id="3-workaround-for-project-quota-issue">3. Workaround for Project Quota issue<a class="headerlink" href="#3-workaround-for-project-quota-issue" title="Permanent link">&para;</a></h2>
<p>If you see following error:</p>
<div class="codehilite"><pre><span></span><code>│ Error: Error setting billing account &quot;010BE6-CA1129-195D77&quot; for project &quot;projects/ayrat-notepad-dev-244&quot;: googleapi: Error 400: Precondition check failed., failedPrecondition
</code></pre></div>

<p>This is due to our Billing account has quota of 5 projects per account.</p>
<p>To solve this issue find all unused accounts:</p>
<div class="codehilite"><pre><span></span><code>gcloud beta billing projects list --billing-account $ACCOUNT_ID
</code></pre></div>

<p>And unlink them, so you have less then 5 projects per account:</p>
<div class="codehilite"><pre><span></span><code>gcloud beta billing projects unlink $PROJECT_ID
</code></pre></div>

<h2 id="4-commit-readme-doc-to-repository-and-share-it-with-instructorteacher">4 Commit Readme doc to repository and share it with Instructor/Teacher<a class="headerlink" href="#4-commit-readme-doc-to-repository-and-share-it-with-instructorteacher" title="Permanent link">&para;</a></h2>
<p><strong>Step 1</strong> Commit <code>docs</code> folder using the following Git commands:</p>
<div class="codehilite"><pre><span></span><code>cd ~/$MY_REPO
</code></pre></div>

<div class="codehilite"><pre><span></span><code>git add .
git commit -m &quot;Readme doc for Production GKE Creation using gcloud&quot;
</code></pre></div>

<p><strong>Step 2</strong> Push commit to the Cloud Source Repositories:</p>
<div class="codehilite"><pre><span></span><code>git push origin master
</code></pre></div>

<h2 id="5-cleanup">5 Cleanup<a class="headerlink" href="#5-cleanup" title="Permanent link">&para;</a></h2>
<p>We only going to cleanup GCP Service foundation layer, as we going to use GCP project in future.</p>
<div class="codehilite"><pre><span></span><code>cd ~/$MY_REPO/notepad-infrastructure
terraform destroy -var-file terraform.tfvars
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/googlecloud" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>