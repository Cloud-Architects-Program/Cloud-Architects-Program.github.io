<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>ycit019 Lab 4 Docker Images copy - Cloud Architecture</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../css/extra.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Cloud Architecture</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">YCIT020 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Labs</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../020_Module_2_Lab_Terraform_Fundamentals" class="dropdown-item">Module 2 Terraform Fundamentals</a>
</li>
            
<li>
    <a href="../020_Lab_4_Traffic_control/" class="dropdown-item">Module 8 Traffic Management</a>
</li>
            
<li>
    <a href="../020_Lab_5_EFK/" class="dropdown-item">Module 9 EFK Stack</a>
</li>
            
<li>
    <a href="../020_Lab_6_Prometheus/" class="dropdown-item">Module 10 Monitoring with Prometheus</a>
</li>
            
<li>
    <a href="../020_Lab_6_GMP/" class="dropdown-item">Module 10 Monitoring with GMP</a>
</li>
            
<li>
    <a href="../020_Lab_9_GitOps/" class="dropdown-item">Module 11 GitOps with Flux</a>
</li>
            
<li>
    <a href="../020_Lab_10_cloudrun/" class="dropdown-item">Module 12 SERVERless Cloud Run</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Assignments</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../020_Module_2_Assignment_Terraform_Foundation/" class="dropdown-item">Module 2</a>
</li>
            
<li>
    <a href="../020_Module_3_Assignment_Production_GKE/" class="dropdown-item">Module 3</a>
</li>
            
<li>
    <a href="../020_Module_4_Assignment_Production_GKE/" class="dropdown-item">Module 4</a>
</li>
            
<li>
    <a href="../020_Module_6_Assignment_Helm_Foundation/" class="dropdown-item">Module 6</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">YCIT019 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Labs</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../ycit019_Module_5_Lab_Docker_basics/" class="dropdown-item">Module 5 Lab - Docker Basics</a>
</li>
            
<li>
    <a href="../ycit019_Module_6_Lab_Advanced_Docker/" class="dropdown-item">Module 6 Lab - Advanced Docker</a>
</li>
            
<li>
    <a href="../ycit019_Module_7_Lab_Deploy_Kubernetes_kubeadm/" class="dropdown-item">Module 7 Lab - Deploy Kubernetes Cluster with Kubeadm</a>
</li>
            
<li>
    <a href="../ycit019_Module_8_Lab_Kubernetes_Concepts/" class="dropdown-item">Module 8 Lab - Kuberenetes Concepts</a>
</li>
            
<li>
    <a href="../ycit019_Module_9_Kubernetes_Features/" class="dropdown-item">Module 9 Lab - Kubernetes Features</a>
</li>
            
<li>
    <a href="../ycit019_Module_10_Kubernetes_Scaling/" class="dropdown-item">Module 9 Part 2 Lab Kubernetes Autoscaling</a>
</li>
            
<li>
    <a href="../ycit019_Lab_10_Networking/" class="dropdown-item">Module 10 Lab - Kubernetes Networking</a>
</li>
            
<li>
    <a href="../ycit019_Lab_11_Storage/" class="dropdown-item">Module 11 Lab - Kubernetes Storage</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Assignments</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../ycit019_ass1/" class="dropdown-item">Module 5 Assignment</a>
</li>
            
<li>
    <a href="../ycit019_ass1_sol/" class="dropdown-item">Module 5 Assignment Solution</a>
</li>
            
<li>
    <a href="../ycit019_ass2/" class="dropdown-item">Module 6 Assignment</a>
</li>
            
<li>
    <a href="../ycit019_ass2_solution/" class="dropdown-item">Module 6 Assignment Solution</a>
</li>
            
<li>
    <a href="../ycit019_ass3/" class="dropdown-item">Module 8 Assignment</a>
</li>
            
<li>
    <a href="../ycit019_ass3_solution/" class="dropdown-item">Module 8 Assignment Solution</a>
</li>
            
<li>
    <a href="../ycit019_ass4_2022/" class="dropdown-item">Module 9 Assignment</a>
</li>
            
<li>
    <a href="../ycit019_ass4_sol/" class="dropdown-item">Module 9 Assignment Solution</a>
</li>
            
<li>
    <a href="../ycit019_ass7/" class="dropdown-item">Module 10 Assignment</a>
</li>
            
<li>
    <a href="../ycit019_ass6_solution/" class="dropdown-item">Module 10 Assignment Solution</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#prepare-lab-environment" class="nav-link">Prepare Lab Environment</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#1-distributing-docker-images-with-container-registry" class="nav-link">1 Distributing Docker images with Container Registry</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#11-create-dockerfile" class="nav-link">1.1 Create DOCKERFILE</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#12-build-a-docker-image" class="nav-link">1.2 Build a Docker image</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#2-follow-docker-best-practices" class="nav-link">2 Follow Docker Best Practices</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#21-inspecting-dockerfiles-with-dockle" class="nav-link">2.1 Inspecting Dockerfiles with dockle</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#22-automated-builds-with-google-cloud-build" class="nav-link">2.2 Automated Builds with Google Cloud Build</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>Lab 4 Managing Docker Images</p>
<p><strong>Objective:</strong></p>
<ul>
<li>Learn to build docker images using Dockerfiles.</li>
<li>Store images in Docker Hub</li>
<li>Learn alternative registry solutions (GCR)</li>
</ul>
<h2 id="prepare-lab-environment">Prepare Lab Environment<a class="headerlink" href="#prepare-lab-environment" title="Permanent link">&para;</a></h2>
<p>This lab can be executed in you GCP Cloud Environment using Google Cloud Shell.</p>
<p>Open the Google Cloud Shell by clicking on the icon on the top right of the screen:</p>
<p><img alt="alt text" src="../images/cloud_shell.png" title="Google Cloud Shell" /></p>
<p>Once opened, you can use it to run the instructions for this lab.</p>
<h1 id="1-distributing-docker-images-with-container-registry">1 Distributing Docker images with Container Registry<a class="headerlink" href="#1-distributing-docker-images-with-container-registry" title="Permanent link">&para;</a></h1>
<p>In the previous modules, we learned how to use Docker images
to run Docker containers. Docker images that we used have been downloaded from
the Docker Hub, a Docker image registry maintained by Docker Inc. In this section we will create a
simple web application from scratch. We will use Flask
(<a href="http://flask.pocoo.org/">http://flask.pocoo.org/</a>), a microframework for
Python. Our application for each request will display a random picture from the
defined set.</p>
<p>In the next session we will create all necessary files for our application,
build docker image and then push to Docker Hub and Quay.</p>
<p>The code for this application is also available in GitHub:</p>
<pre class="codehilite"><code>https://github.com/Cloud-Architects-Program/ycit019/tree/main/Module5/flask-app
</code></pre>

<h2 id="11-create-dockerfile">1.1 Create DOCKERFILE<a class="headerlink" href="#11-create-dockerfile" title="Permanent link">&para;</a></h2>
<p><strong>Step 1</strong> Clone git repo on you laptop:</p>
<pre class="codehilite"><code>git clone https://github.com/Cloud-Architects-Program/ycit019
cd ~/ycit019/Module5/flask-app/
</code></pre>

<p><strong>Step 2</strong> In this directory, we see following files:</p>
<pre class="codehilite"><code>flask-app/
    Dockerfile
    app.py
    requirements.txt
    templates/
        index.html
</code></pre>

<p><strong>Step 3</strong> Let’s review file app.py with the following content:</p>
<pre class="codehilite"><code class="language-python">from flask import Flask, render_template
import random

app = Flask(__name__)

# list of cat images
images = [
    &quot;https://media.giphy.com/media/mlvseq9yvZhba/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/13CoXDiaCcCoyk/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/LtVXu5s7KwlK8/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/PekRU0CYIpXS8/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/11quO2C07Sh2oM/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/12HZukMBlutpoQ/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/1HKaikaFqDt7i/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/v6aOjy0Qo1fIA/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/12bjQ7uASAaCKk/giphy.gif&quot;,
    &quot;https://media.giphy.com/media/HFcl9uhuCqzGU/giphy.gif&quot;
]

@app.route('/')
def index():
    url = random.choice(images)
    return render_template('index.html', url=url)

if __name__ == &quot;__main__&quot;:
    app.run(host=&quot;0.0.0.0&quot;)
</code></pre>

<p><strong>Step 4</strong> Below is the content of requirements.txt file:</p>
<pre class="codehilite"><code>Flask==2.0.0
</code></pre>

<p><strong>Step 5</strong> Under directory templates observe index.html with the following
content:</p>
<pre class="codehilite"><code class="language-html">&lt;html&gt;
  &lt;head&gt;
    &lt;style type=&quot;text/css&quot;&gt;
      body {
        background: black;
        color: white;
      }
      div.container {
        max-width: 500px;
        margin: 100px auto;
        border: 20px solid white;
        padding: 10px;
        text-align: center;
      }
      h4 {
        text-transform: uppercase;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class=&quot;container&quot;&gt;
      &lt;h4&gt;Cat Gif of the day&lt;/h4&gt;
      &lt;img src=&quot;{{url}}&quot; /&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p><strong>Step 6</strong> Let’s review content of the Dockerfile:</p>
<pre class="codehilite"><code class="language-docker"># Official Python Alpine Base image using Simple Tags
# Image contains Python 3 and pip pre-installed, so no need to install them

FROM python:3.9.5-alpine3.12

# Specify Working directory
WORKDIR /usr/src/app

# COPY requirements.txt /usr/src/app/
COPY requirements.txt ./

# Install Python Flask used by the Python app
RUN pip install --no-cache-dir -r requirements.txt

# Copy files required for the app to run
COPY app.py ./
COPY templates/index.html ./templates/

# Make a record that the port number the container should be expose is:
EXPOSE 5000

# run the application
CMD [&quot;python&quot;, &quot;./app.py&quot;]
</code></pre>

<h2 id="12-build-a-docker-image">1.2 Build a Docker image<a class="headerlink" href="#12-build-a-docker-image" title="Permanent link">&para;</a></h2>
<p><strong>Step 1</strong> Now let’s build our Docker image. In the command below, replace
<Docker-hub-user-name> with your user name. This user name should be the same as you
created when you registered on Docker Hub. Because we will publish our build
image in the next step to your own Docker Hub.</p>
<pre class="codehilite"><code>docker build -t &lt;Docker-hub-user-name&gt;/myfirstapp .
</code></pre>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Image has been buit </p>
</div>
<p><strong>Step 2</strong> Where is your built image? It’s in your machine’s local Docker image
registry, you can check that your image exists with command below:</p>
<pre class="codehilite"><code>docker images
</code></pre>

<p><strong>Step 3</strong> Now run a container in a background and expose a standard HTTP port
(80), which is redirected to the container’s port 5000:</p>
<pre class="codehilite"><code>docker run -dp 8080:5000 --name myfirstapp &lt;Docker-hub-user-name&gt;/myfirstapp
</code></pre>

<p><strong>Step 4</strong> Now that we've launched the application containers, let's try to test the web
application locally.</p>
<p>You should be able to access the application at Google Cloud <code>Web Preview</code> Console:</p>
<p><img alt="alt text" src="../images/web_preview.png" title="Web Preview" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Web Preview using port <code>8080</code> by default. If you application using other port, you can edit this as needed.</p>
</div>
<p><strong>Step 5</strong> Stop the container and remove it:</p>
<pre class="codehilite"><code>docker rm -f myfirstapp
</code></pre>

<h3 id="122-publish-docker-image-to-docker-hub">1.2.2 Publish Docker Image to Docker Hub<a class="headerlink" href="#122-publish-docker-image-to-docker-hub" title="Permanent link">&para;</a></h3>
<p>One of the most popular way to share and work with you images is to push
them to the Docker Hub.</p>
<p><strong>Docker Hub</strong> is a <a href="https://hub.docker.com/explore/">registry</a>
of Docker images. You can think of the registry as a directory of all available
Docker images.</p>
<p><strong>Step 1 (Optional)</strong> If you don’t have a Docker account, sign up for one
<a href="https://hub.docker.com/">here</a>. Make a note of your username and password.</p>
<p><strong>Step 2</strong> Log in to your local machine.</p>
<pre class="codehilite"><code>docker login
</code></pre>

<p><strong>Step 3</strong> Now, publish your image to docker Hub.</p>
<pre class="codehilite"><code>docker push &lt;Docker-hub-user-name&gt;/myfirstapp
</code></pre>

<p><strong>Step 4</strong> Login to <a href="https://hub.docker.com">https://hub.docker.com</a> and verify
simage and tags.</p>
<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Image been pushed and can be observed in Docker Hub, with the <strong>tag</strong> latest.</p>
</div>
<p><strong>Step 5</strong> It is also possible to specify a custom tag for image prior to push
it to the registry</p>
<p>Note Image Tag of the created <code>myfirstapp</code>:</p>
<pre class="codehilite"><code>docker images
</code></pre>

<p>Modify <code>$docker_image_tag</code> with <code>myfirstapp:v1</code> image tag value:</p>
<pre class="codehilite"><code>docker tag $docker_image_tag &lt;Docker-hub-user-name&gt;/myfirstapp:v1
docker push &lt;Docker-hub-user-name&gt;/myfirstapp:v1
</code></pre>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Image been pushed and can be observed in Docker Hub. You can now
observe 2 docker image one with the <strong>tag</strong> latest and another with tag v1</p>
</div>
<p><strong>Step 6</strong> You can now <strong>pull</strong> or <strong>run</strong> specified <strong>Docker images</strong> from any
other location where docker engine is installed with following commands:</p>
<pre class="codehilite"><code>docker pull &lt;Docker-hub-user-name&gt;/myfirstapp:latest

docker pull &lt;Docker-hub-user-name&gt;/myfirstapp:v1
</code></pre>

<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Images stored locally</p>
</div>
<pre class="codehilite"><code>docker images
</code></pre>

<p><strong>Output:</strong></p>
<pre class="codehilite"><code>myfirstapp       v1       f50f9524513f    1 hour ago   22 MB

myfirstapp       latest   f50f9524513f    1 hour ago   22 MB
</code></pre>

<p>Finally run images with specific tag:</p>
<pre class="codehilite"><code>docker run &lt;Docker-hub-user-name&gt;/myfirstapp:v1
</code></pre>

<h3 id="123-pushing-images-to-gcrio">1.2.3 Pushing images to gcr.io<a class="headerlink" href="#123-pushing-images-to-gcrio" title="Permanent link">&para;</a></h3>
<p>In a similar manner we need to tag the image to prepare it to be pushed to gcr.io. We just need to change the registry, which is for gcr.io formatted as gcr.io/PROJECT_ID.</p>
<p><strong>Step 1</strong> Get the Project ID:</p>
<pre class="codehilite"><code>PROJECT_ID=$(gcloud config get-value project)
</code></pre>

<p><strong>Step 2</strong> Enable the required APIs:</p>
<pre class="codehilite"><code>gcloud services enable containerregistry.googleapis.com
</code></pre>

<p><strong>Step 3</strong> Tag the image:</p>
<p>Modify <code>$docker_image_tag</code> with <code>myfirstapp:v1</code> image tag value:</p>
<pre class="codehilite"><code>docker tag $docker_image_tag gcr.io/${PROJECT_ID}/myfirstapp:v1
</code></pre>

<p>$docker_image_tag
Push the image to gcr.io:</p>
<pre class="codehilite"><code>docker push gcr.io/${PROJECT_ID}/myfirstapp:v1
</code></pre>

<p><strong>Step 4</strong>  Login to GCP console -&gt; Container Registry -&gt; Images</p>
<div class="admonition result">
<p class="admonition-title">Result</p>
<p>Docker images has been pushed to GCR registry</p>
</div>
<h3 id="123-pushing-images-to-local-repository">1.2.3 Pushing images to Local Repository<a class="headerlink" href="#123-pushing-images-to-local-repository" title="Permanent link">&para;</a></h3>
<p>First, we need to spin up a local docker registry. This could be a use case if you want to deploy basic registry On-Prem.
This registry will luck security features such as Authentication, SSL, scanning.
If you interested to use Enterprise ready solution On-Prem consider: Jfrog Artifactory, RedHa's Clair, Docker Enterprise or
open source CNCF project Harbor.</p>
<p><strong>Step 1</strong> Deploy local registry</p>
<pre class="codehilite"><code>docker run -d -p 5000:5000 --name registry registry:2.7.1
</code></pre>

<p><strong>Step 2</strong> In order to upload an image to a registry, we need to tag it properly</p>
<p>Modify <code>$docker_image_tag</code> with <code>myfirstapp:v1</code> image tag value:</p>
<pre class="codehilite"><code>docker tag $docker_image_tag localhost:5000/myfirstapp:v1
</code></pre>

<p><strong>Step 3</strong> Now that we have an image tagged correctly, we can push it to our local registry</p>
<pre class="codehilite"><code>docker push localhost:5000/myfirstapp:v1
</code></pre>

<p><strong>Step 4</strong> Let’s now delete the local image, and pull it again from the local registry</p>
<p>To delete the image, we need to first remove the container that depends on that image.
Run <code>docker ps</code> and get the Container_ID for the container that uses  myfirstapp:v1
Kill and delete that container by running the following command, but make sure to replace CONTAINER_ID, with the actual ID.</p>
<pre class="codehilite"><code>docker rm CONTAINER_ID
</code></pre>

<p>Result: The command will print back the container ID, which is an indication it was successful.</p>
<p><strong>Step 5</strong> Run docker images to validate</p>
<pre class="codehilite"><code>docker images
</code></pre>

<p><strong>Step 6</strong> Now we can delete the docker image</p>
<pre class="codehilite"><code>docker rmi localhost:5000/myfirstapp:v1
</code></pre>

<p><strong>Step 7</strong> Although the image is deleted locally, it is still in the registry and we can pull it back, or use it to deploy containers.</p>
<pre class="codehilite"><code>docker run -dp 8080:5000 --name myfirstapp localhost:5000/myfirstapp:v1
</code></pre>

<p>Run <code>docker images</code> again to check how the image is available locally again.</p>
<pre class="codehilite"><code>docker images
</code></pre>

<p><strong>Step 8 Cleanup:</strong></p>
<pre class="codehilite"><code>docker rm -f myfirstapp
</code></pre>

<h1 id="2-follow-docker-best-practices">2 Follow Docker Best Practices<a class="headerlink" href="#2-follow-docker-best-practices" title="Permanent link">&para;</a></h1>
<h2 id="21-inspecting-dockerfiles-with-dockle">2.1 Inspecting Dockerfiles with <code>dockle</code><a class="headerlink" href="#21-inspecting-dockerfiles-with-dockle" title="Permanent link">&para;</a></h2>
<p><code>Dockle</code> - Container Image Linter for Security, Helping build the Best-Practice Docker Image, Easy to start</p>
<p><code>Dockle</code> helps you:</p>
<ul>
<li>Build Best Practice Docker images</li>
<li>Build secure Docker images</li>
<li>Checkpoints includes CIS Benchmarks</li>
</ul>
<p><strong>Step 1</strong>  Install Dockle</p>
<pre class="codehilite"><code>$ VERSION=$(
 curl --silent &quot;https://api.github.com/repos/goodwithtech/dockle/releases/latest&quot; | \
 grep '&quot;tag_name&quot;:' | \
 sed -E 's/.*&quot;v([^&quot;]+)&quot;.*/\1/' \
) &amp;&amp; curl -L -o dockle.deb https://github.com/goodwithtech/dockle/releases/download/v${VERSION}/dockle_${VERSION}_Linux-64bit.deb
$ sudo dpkg -i dockle.deb &amp;&amp; rm dockle.deb
</code></pre>

<p><strong>Step 2</strong> Experiment with existing applications we've created in the class:</p>
<pre class="codehilite"><code>$ dockle [YOUR_IMAGE_NAME]
</code></pre>

<p>e.g.</p>
<pre class="codehilite"><code>dockle archy/myfirstapp
</code></pre>

<p>output:</p>
<pre class="codehilite"><code>WARN    - CIS-DI-0001: Create a user for the container
    * Last user should not be root
WARN    - DKL-DI-0006: Avoid latest tag
    * Avoid 'latest' tag
INFO    - CIS-DI-0005: Enable Content trust for Docker
    * export DOCKER_CONTENT_TRUST=1 before docker pull/build
INFO    - CIS-DI-0006: Add HEALTHCHECK instruction to the container image
    * not found HEALTHCHECK statement
INFO    - DKL-LI-0003: Only put necessary files
    * Suspicious directory : tmp
</code></pre>

<h2 id="22-automated-builds-with-google-cloud-build">2.2 Automated Builds with Google Cloud Build<a class="headerlink" href="#22-automated-builds-with-google-cloud-build" title="Permanent link">&para;</a></h2>
<p><strong>Live Demo:</strong></p>
<ul>
<li>GCR Image scanning</li>
<li>Setting Up Docker Image Auto-Build with Google Cloud Build based on Push to Branch</li>
<li>Auto Deployment of Image to Cloud Run</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
